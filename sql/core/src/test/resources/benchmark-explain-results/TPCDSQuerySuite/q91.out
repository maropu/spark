*Sort [Returns_Loss#0 DESC NULLS LAST], true, 0
+- Exchange rangepartitioning(Returns_Loss#0 DESC NULLS LAST, 5)
   +- *HashAggregate(keys=[cc_call_center_id#0, cc_name#0, cc_manager#0, cd_marital_status#0, cd_education_status#0], functions=[sum(UnscaledValue(cr_net_loss#0))])
      +- Exchange hashpartitioning(cc_call_center_id#0, cc_name#0, cc_manager#0, cd_marital_status#0, cd_education_status#0, 5)
         +- *HashAggregate(keys=[cc_call_center_id#0, cc_name#0, cc_manager#0, cd_marital_status#0, cd_education_status#0], functions=[partial_sum(UnscaledValue(cr_net_loss#0))])
            +- *Project [cd_education_status#0, cc_name#0, cc_call_center_id#0, cc_manager#0, cr_net_loss#0, cd_marital_status#0]
               +- *BroadcastHashJoin [c_current_hdemo_sk#0], [hd_demo_sk#0], Inner, BuildRight
                  :- *Project [c_current_hdemo_sk#0, cd_education_status#0, cc_name#0, cc_call_center_id#0, cc_manager#0, cr_net_loss#0, cd_marital_status#0]
                  :  +- *BroadcastHashJoin [c_current_cdemo_sk#0], [cd_demo_sk#0], Inner, BuildRight
                  :     :- *Project [c_current_hdemo_sk#0, cc_name#0, cc_call_center_id#0, c_current_cdemo_sk#0, cc_manager#0, cr_net_loss#0]
                  :     :  +- *BroadcastHashJoin [c_current_addr_sk#0], [ca_address_sk#0], Inner, BuildRight
                  :     :     :- *Project [c_current_addr_sk#0, c_current_hdemo_sk#0, cc_name#0, cc_call_center_id#0, c_current_cdemo_sk#0, cc_manager#0, cr_net_loss#0]
                  :     :     :  +- *BroadcastHashJoin [cr_returning_customer_sk#0], [c_customer_sk#0], Inner, BuildRight
                  :     :     :     :- *Project [cr_returning_customer_sk#0, cc_name#0, cc_call_center_id#0, cc_manager#0, cr_net_loss#0]
                  :     :     :     :  +- *BroadcastHashJoin [cr_returned_date_sk#0], [d_date_sk#0], Inner, BuildRight
                  :     :     :     :     :- *Project [cr_returning_customer_sk#0, cc_name#0, cc_call_center_id#0, cc_manager#0, cr_net_loss#0, cr_returned_date_sk#0]
                  :     :     :     :     :  +- *BroadcastHashJoin [cc_call_center_sk#0], [cr_call_center_sk#0], Inner, BuildRight
                  :     :     :     :     :     :- *Project [cc_name#0, cc_call_center_id#0, cc_manager#0, cc_call_center_sk#0]
                  :     :     :     :     :     :  +- *Filter isnotnull(cc_call_center_sk#0)
                  :     :     :     :     :     :     +- *FileScan parquet default.call_center[cc_call_center_sk#0,cc_call_center_id#0,cc_name#0,cc_manager#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,cc_manager:string>
                  :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[2, int, true] as bigint)))
                  :     :     :     :     :        +- *Project [cr_returning_customer_sk#0, cr_net_loss#0, cr_returned_date_sk#0, cr_call_center_sk#0]
                  :     :     :     :     :           +- *Filter ((isnotnull(cr_call_center_sk#0) && isnotnull(cr_returned_date_sk#0)) && isnotnull(cr_returning_customer_sk#0))
                  :     :     :     :     :              +- *FileScan parquet default.catalog_returns[cr_returned_date_sk#0,cr_returning_customer_sk#0,cr_call_center_sk#0,cr_net_loss#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,cr_net_loss:dec...
                  :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                  :     :     :     :        +- *Project [d_date_sk#0]
                  :     :     :     :           +- *Filter ((((isnotnull(d_date_sk#0) && isnotnull(d_moy#0)) && isnotnull(d_year#0)) && (1998 = d_year#0)) && (d_moy#0 = 11))
                  :     :     :     :              +- *FileScan parquet default.date_dim[d_date_sk#0,d_year#0,d_moy#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,d_moy:int>
                  :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                  :     :     :        +- *Project [c_current_addr_sk#0, c_current_hdemo_sk#0, c_customer_sk#0, c_current_cdemo_sk#0]
                  :     :     :           +- *Filter (((isnotnull(c_current_addr_sk#0) && isnotnull(c_current_hdemo_sk#0)) && isnotnull(c_customer_sk#0)) && isnotnull(c_current_cdemo_sk#0))
                  :     :     :              +- *FileScan parquet default.customer[c_customer_sk#0,c_current_cdemo_sk#0,c_current_hdemo_sk#0,c_current_addr_sk#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,c_current_addr_sk:int>
                  :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                  :     :        +- *Project [ca_address_sk#0]
                  :     :           +- *Filter (((-7.00 = ca_gmt_offset#0) && isnotnull(ca_address_sk#0)) && isnotnull(ca_gmt_offset#0))
                  :     :              +- *FileScan parquet default.customer_address[ca_address_sk#0,ca_gmt_offset#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,2)>
                  :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                  :        +- *Project [cd_education_status#0, cd_marital_status#0, cd_demo_sk#0]
                  :           +- *Filter ((((M = cd_marital_status#0) && (cd_education_status#0 = Unknown)) || ((Advanced Degree = cd_education_status#0) && (cd_marital_status#0 = W))) && isnotnull(cd_demo_sk#0))
                  :              +- *FileScan parquet default.customer_demographics[cd_demo_sk#0,cd_marital_status#0,cd_education_status#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,cd_education_status:string>
                  +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                     +- *Project [hd_demo_sk#0]
                        +- *Filter ((isnotnull(hd_buy_potential#0) && StartsWith(hd_buy_potential#0, Unknown)) && isnotnull(hd_demo_sk#0))
                           +- *FileScan parquet default.household_demographics[hd_demo_sk#0,hd_buy_potential#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,hd_buy_potential:string>
