TakeOrderedAndProject(limit=100, orderBy=[ca_zip#0 ASC NULLS FIRST,ca_city#0 ASC NULLS FIRST], output=[ca_zip#0,ca_city#0,sum(ws_sales_price)#0])
+- *HashAggregate(keys=[ca_zip#0, ca_city#0], functions=[sum(UnscaledValue(ws_sales_price#0))])
   +- Exchange hashpartitioning(ca_zip#0, ca_city#0, 5)
      +- *HashAggregate(keys=[ca_zip#0, ca_city#0], functions=[partial_sum(UnscaledValue(ws_sales_price#0))])
         +- *Project [ca_city#0, ca_zip#0, ws_sales_price#0]
            +- *Filter (substring(ca_zip#0, 1, 5) IN (85669,86197,88274,83405,86475,85392,85460,80348,81792) || exists#0)
               +- *BroadcastHashJoin [i_item_id#0], [i_item_id#0#0], ExistenceJoin(exists#4959), BuildRight
                  :- *Project [ca_city#0, i_item_id#0, ca_zip#0, ws_sales_price#0]
                  :  +- *BroadcastHashJoin [ws_item_sk#0], [i_item_sk#0], Inner, BuildRight
                  :     :- *Project [ca_city#0, ws_item_sk#0, ca_zip#0, ws_sales_price#0]
                  :     :  +- *BroadcastHashJoin [ws_sold_date_sk#0], [d_date_sk#0], Inner, BuildRight
                  :     :     :- *Project [ca_city#0, ws_item_sk#0, ws_sold_date_sk#0, ca_zip#0, ws_sales_price#0]
                  :     :     :  +- *BroadcastHashJoin [c_current_addr_sk#0], [ca_address_sk#0], Inner, BuildRight
                  :     :     :     :- *Project [c_current_addr_sk#0, ws_item_sk#0, ws_sold_date_sk#0, ws_sales_price#0]
                  :     :     :     :  +- *BroadcastHashJoin [ws_bill_customer_sk#0], [c_customer_sk#0], Inner, BuildRight
                  :     :     :     :     :- *Project [ws_bill_customer_sk#0, ws_item_sk#0, ws_sold_date_sk#0, ws_sales_price#0]
                  :     :     :     :     :  +- *Filter ((isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0)) && isnotnull(ws_bill_customer_sk#0))
                  :     :     :     :     :     +- *FileScan parquet default.web_sales[ws_sold_date_sk#0,ws_item_sk#0,ws_bill_customer_sk#0,ws_sales_price#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,2)>
                  :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                  :     :     :     :        +- *Project [c_current_addr_sk#0, c_customer_sk#0]
                  :     :     :     :           +- *Filter (isnotnull(c_current_addr_sk#0) && isnotnull(c_customer_sk#0))
                  :     :     :     :              +- *FileScan parquet default.customer[c_customer_sk#0,c_current_addr_sk#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,c_current_addr_sk:int>
                  :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                  :     :     :        +- *Project [ca_city#0, ca_address_sk#0, ca_zip#0]
                  :     :     :           +- *Filter isnotnull(ca_address_sk#0)
                  :     :     :              +- *FileScan parquet default.customer_address[ca_address_sk#0,ca_city#0,ca_zip#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,ca_zip:string>
                  :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                  :     :        +- *Project [d_date_sk#0]
                  :     :           +- *Filter ((((isnotnull(d_date_sk#0) && (2 = d_qoy#0)) && (2001 = d_year#0)) && isnotnull(d_year#0)) && isnotnull(d_qoy#0))
                  :     :              +- *FileScan parquet default.date_dim[d_date_sk#0,d_year#0,d_qoy#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,d_qoy:int>
                  :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                  :        +- *Project [i_item_sk#0, i_item_id#0]
                  :           +- *Filter isnotnull(i_item_sk#0)
                  :              +- *FileScan parquet default.item[i_item_sk#0,i_item_id#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,i_item_id:string>
                  +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, true]))
                     +- *Project [i_item_id#0 AS none#0]
                        +- *Filter i_item_sk#0 IN (2,3,5,7,11,13,17,19,23,29)
                           +- *FileScan parquet default.item[i_item_sk#0,i_item_id#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,i_item_id:string>
