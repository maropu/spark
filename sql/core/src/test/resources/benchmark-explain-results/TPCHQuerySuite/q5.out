*Sort [revenue#0 DESC NULLS LAST], true, 0
+- Exchange rangepartitioning(revenue#0 DESC NULLS LAST, 5)
   +- *HashAggregate(keys=[n_name#0], functions=[sum(CheckOverflow((promote_precision(cast(l_extendedprice#0 as decimal(11,0))) * promote_precision(CheckOverflow((1 - promote_precision(cast(l_discount#0 as decimal(11,0)))), DecimalType(11,0)))), DecimalType(22,0)))])
      +- Exchange hashpartitioning(n_name#0, 5)
         +- *HashAggregate(keys=[n_name#0], functions=[partial_sum(CheckOverflow((promote_precision(cast(l_extendedprice#0 as decimal(11,0))) * promote_precision(CheckOverflow((1 - promote_precision(cast(l_discount#0 as decimal(11,0)))), DecimalType(11,0)))), DecimalType(22,0)))])
            +- *Project [l_discount#0, n_name#0, l_extendedprice#0]
               +- *BroadcastHashJoin [n_regionkey#0L], [r_regionkey#0L], Inner, BuildRight
                  :- *Project [l_discount#0, n_regionkey#0L, n_name#0, l_extendedprice#0]
                  :  +- *BroadcastHashJoin [s_nationkey#0L], [n_nationkey#0L], Inner, BuildRight
                  :     :- *Project [s_nationkey#0L, l_discount#0, l_extendedprice#0]
                  :     :  +- *BroadcastHashJoin [l_suppkey#0L, cast(c_nationkey#0 as bigint)], [s_suppkey#0L, s_nationkey#0L], Inner, BuildRight
                  :     :     :- *Project [l_discount#0, l_suppkey#0L, c_nationkey#0, l_extendedprice#0]
                  :     :     :  +- *BroadcastHashJoin [o_orderkey#0L], [l_orderkey#0L], Inner, BuildRight
                  :     :     :     :- *Project [o_orderkey#0L, c_nationkey#0]
                  :     :     :     :  +- *BroadcastHashJoin [c_custkey#0L], [o_custkey#0L], Inner, BuildRight
                  :     :     :     :     :- *Project [c_custkey#0L, c_nationkey#0]
                  :     :     :     :     :  +- *Filter (isnotnull(c_nationkey#0) && isnotnull(c_custkey#0L))
                  :     :     :     :     :     +- *FileScan parquet default.customer[c_custkey#0L,c_nationkey#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,c_nationkey:string>
                  :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[1, bigint, true]))
                  :     :     :     :        +- *Project [o_custkey#0L, o_orderkey#0L]
                  :     :     :     :           +- *Filter ((((isnotnull(o_orderdate#0) && isnotnull(o_custkey#0L)) && (o_orderdate#0 < 9131)) && isnotnull(o_orderkey#0L)) && (o_orderdate#0 >= 8766))
                  :     :     :     :              +- *FileScan parquet default.orders[o_orderkey#0L,o_custkey#0L,o_orderdate#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,o_orderdate:date>
                  :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, bigint, true]))
                  :     :     :        +- *Project [l_discount#0, l_suppkey#0L, l_orderkey#0L, l_extendedprice#0]
                  :     :     :           +- *Filter (isnotnull(l_orderkey#0L) && isnotnull(l_suppkey#0L))
                  :     :     :              +- *FileScan parquet default.lineitem[l_orderkey#0L,l_suppkey#0L,l_extendedprice#0,l_discount#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,0)>
                  :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, bigint, true], input[1, bigint, true]))
                  :     :        +- *Project [s_suppkey#0L, s_nationkey#0L]
                  :     :           +- *Filter (isnotnull(s_suppkey#0L) && isnotnull(s_nationkey#0L))
                  :     :              +- *FileScan parquet default.supplier[s_suppkey#0L,s_nationkey#0L] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,s_nationkey:bigint>
                  :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, bigint, true]))
                  :        +- *Project [n_regionkey#0L, n_name#0, n_nationkey#0L]
                  :           +- *Filter (isnotnull(n_regionkey#0L) && isnotnull(n_nationkey#0L))
                  :              +- *FileScan parquet default.nation[n_nationkey#0L,n_name#0,n_regionkey#0L] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,n_regionkey:bigint>
                  +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, bigint, true]))
                     +- *Project [r_regionkey#0L]
                        +- *Filter ((isnotnull(r_name#0) && isnotnull(r_regionkey#0L)) && (ASIA = r_name#0))
                           +- *FileScan parquet default.region[r_regionkey#0L,r_name#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,r_name:string>
