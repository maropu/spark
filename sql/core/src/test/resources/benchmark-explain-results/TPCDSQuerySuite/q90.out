TakeOrderedAndProject(limit=100, orderBy=[am_pm_ratio#0 ASC NULLS FIRST], output=[am_pm_ratio#0])
+- *Project [CheckOverflow((promote_precision(cast(amc#0L as decimal(15,4))) / promote_precision(cast(pmc#0L as decimal(15,4)))), DecimalType(35,20)) AS none#0]
   +- BroadcastNestedLoopJoin BuildRight, Inner
      :- *HashAggregate(keys=[], functions=[count(1)])
      :  +- Exchange SinglePartition
      :     +- *HashAggregate(keys=[], functions=[partial_count(1)])
      :        +- *Project
      :           +- *BroadcastHashJoin [ws_web_page_sk#0], [wp_web_page_sk#0], Inner, BuildRight
      :              :- *Project [ws_web_page_sk#0]
      :              :  +- *BroadcastHashJoin [ws_sold_time_sk#0], [t_time_sk#0], Inner, BuildRight
      :              :     :- *Project [ws_web_page_sk#0, ws_sold_time_sk#0]
      :              :     :  +- *BroadcastHashJoin [ws_ship_hdemo_sk#0], [hd_demo_sk#0], Inner, BuildRight
      :              :     :     :- *Project [ws_ship_hdemo_sk#0, ws_web_page_sk#0, ws_sold_time_sk#0]
      :              :     :     :  +- *Filter ((isnotnull(ws_ship_hdemo_sk#0) && isnotnull(ws_sold_time_sk#0)) && isnotnull(ws_web_page_sk#0))
      :              :     :     :     +- *FileScan parquet default.web_sales[ws_sold_time_sk#0,ws_ship_hdemo_sk#0,ws_web_page_sk#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,ws_web_page_sk:int>
      :              :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
      :              :     :        +- *Project [hd_demo_sk#0]
      :              :     :           +- *Filter (((hd_dep_count#0 = 6) && isnotnull(hd_demo_sk#0)) && isnotnull(hd_dep_count#0))
      :              :     :              +- *FileScan parquet default.household_demographics[hd_demo_sk#0,hd_dep_count#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,hd_dep_count:int>
      :              :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
      :              :        +- *Project [t_time_sk#0]
      :              :           +- *Filter ((((t_hour#0 <= 9) && isnotnull(t_hour#0)) && (t_hour#0 >= 8)) && isnotnull(t_time_sk#0))
      :              :              +- *FileScan parquet default.time_dim[t_time_sk#0,t_hour#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,t_hour:int>
      :              +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
      :                 +- *Project [wp_web_page_sk#0]
      :                    +- *Filter (((isnotnull(wp_web_page_sk#0) && isnotnull(wp_char_count#0)) && (5000 <= wp_char_count#0)) && (5200 >= wp_char_count#0))
      :                       +- *FileScan parquet default.web_page[wp_web_page_sk#0,wp_char_count#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,wp_char_count:int>
      +- BroadcastExchange IdentityBroadcastMode
         +- *HashAggregate(keys=[], functions=[count(1)])
            +- Exchange SinglePartition
               +- *HashAggregate(keys=[], functions=[partial_count(1)])
                  +- *Project
                     +- *BroadcastHashJoin [ws_web_page_sk#0], [wp_web_page_sk#0], Inner, BuildRight
                        :- *Project [ws_web_page_sk#0]
                        :  +- *BroadcastHashJoin [ws_sold_time_sk#0], [t_time_sk#0], Inner, BuildRight
                        :     :- *Project [ws_web_page_sk#0, ws_sold_time_sk#0]
                        :     :  +- *BroadcastHashJoin [ws_ship_hdemo_sk#0], [hd_demo_sk#0], Inner, BuildRight
                        :     :     :- *Project [ws_ship_hdemo_sk#0, ws_web_page_sk#0, ws_sold_time_sk#0]
                        :     :     :  +- *Filter ((isnotnull(ws_ship_hdemo_sk#0) && isnotnull(ws_sold_time_sk#0)) && isnotnull(ws_web_page_sk#0))
                        :     :     :     +- *FileScan parquet default.web_sales[ws_sold_time_sk#0,ws_ship_hdemo_sk#0,ws_web_page_sk#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,ws_web_page_sk:int>
                        :     :     +- ReusedExchange [hd_demo_sk#0], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                        :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                        :        +- *Project [t_time_sk#0]
                        :           +- *Filter (((isnotnull(t_hour#0) && isnotnull(t_time_sk#0)) && (t_hour#0 <= 20)) && (t_hour#0 >= 19))
                        :              +- *FileScan parquet default.time_dim[t_time_sk#0,t_hour#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,t_hour:int>
                        +- ReusedExchange [wp_web_page_sk#0], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
