TakeOrderedAndProject(limit=100, orderBy=[Excess Discount Amount #0 ASC NULLS FIRST], output=[Excess Discount Amount #0])
+- *HashAggregate(keys=[], functions=[sum(UnscaledValue(ws_ext_discount_amt#0))])
   +- Exchange SinglePartition
      +- *HashAggregate(keys=[], functions=[partial_sum(UnscaledValue(ws_ext_discount_amt#0))])
         +- *Project [ws_ext_discount_amt#0]
            +- *BroadcastHashJoin [ws_sold_date_sk#0], [d_date_sk#0], Inner, BuildRight
               :- *Project [ws_ext_discount_amt#0, ws_sold_date_sk#0]
               :  +- *BroadcastHashJoin [i_item_sk#0], [ws_item_sk#0#0], Inner, BuildRight, (cast(ws_ext_discount_amt#0 as decimal(14,7)) > (CAST(1.3 AS DECIMAL(11,6)) * CAST(avg(ws_ext_discount_amt) AS DECIMAL(11,6)))#0)
               :     :- *Project [i_item_sk#0, ws_ext_discount_amt#0, ws_sold_date_sk#0]
               :     :  +- *BroadcastHashJoin [ws_item_sk#0], [i_item_sk#0], Inner, BuildRight
               :     :     :- *Project [ws_ext_discount_amt#0, ws_item_sk#0, ws_sold_date_sk#0]
               :     :     :  +- *Filter ((isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0)) && isnotnull(ws_ext_discount_amt#0))
               :     :     :     +- *FileScan parquet default.web_sales[ws_sold_date_sk#0,ws_item_sk#0,ws_ext_discount_amt#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,2)>
               :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
               :     :        +- *Project [i_item_sk#0]
               :     :           +- *Filter ((isnotnull(i_manufact_id#0) && isnotnull(i_item_sk#0)) && (350 = i_manufact_id#0))
               :     :              +- *FileScan parquet default.item[i_item_sk#0,i_manufact_id#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,i_manufact_id:int>
               :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[1, int, true] as bigint)))
               :        +- *Filter isnotnull((CAST(1.3 AS DECIMAL(11,6)) * CAST(avg(ws_ext_discount_amt) AS DECIMAL(11,6)))#0)
               :           +- *HashAggregate(keys=[ws_item_sk#0], functions=[avg(UnscaledValue(ws_ext_discount_amt#0))])
               :              +- Exchange hashpartitioning(ws_item_sk#0, 5)
               :                 +- *HashAggregate(keys=[ws_item_sk#0], functions=[partial_avg(UnscaledValue(ws_ext_discount_amt#0))])
               :                    +- *Project [ws_ext_discount_amt#0, ws_item_sk#0]
               :                       +- *BroadcastHashJoin [ws_sold_date_sk#0], [d_date_sk#0], Inner, BuildRight
               :                          :- *Project [ws_ext_discount_amt#0, ws_item_sk#0, ws_sold_date_sk#0]
               :                          :  +- *Filter (isnotnull(ws_item_sk#0) && isnotnull(ws_sold_date_sk#0))
               :                          :     +- *FileScan parquet default.web_sales[ws_sold_date_sk#0,ws_item_sk#0,ws_ext_discount_amt#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,2)>
               :                          +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
               :                             +- *Project [d_date_sk#0]
               :                                +- *Filter (((isnotnull(d_date_sk#0) && (d_date#0 >= 2000-01-27)) && isnotnull(d_date#0)) && (2000-04-26 >= d_date#0))
               :                                   +- *FileScan parquet default.date_dim[d_date_sk#0,d_date#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,d_date:string>
               +- ReusedExchange [d_date_sk#0], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
