-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 19


-- !query 0
create temporary view t1 as select * from values
  ("one", 1),
  ("two", 2),
  ("three", 3),
  ("one", NULL)
  as t1(k, v)
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
create temporary view t2 as select * from values
  ("one", 1),
  ("two", 22),
  ("one", 5),
  ("one", NULL),
  (NULL, 5)
  as t2(k, v)
-- !query 1 schema
struct<>
-- !query 1 output



-- !query 2
SELECT * FROM t1 EXCEPT SELECT * FROM t2
-- !query 2 schema
struct<k:string,v:int>
-- !query 2 output
three	3
two	2


-- !query 3
SELECT * FROM t1 EXCEPT SELECT * FROM t1 where v <> 1 and v <> 2
-- !query 3 schema
struct<k:string,v:int>
-- !query 3 output
one	1
one	NULL
two	2


-- !query 4
SELECT * FROM t1 where v <> 1 and v <> 22 EXCEPT SELECT * FROM t1 where v <> 2 and v >= 3
-- !query 4 schema
struct<k:string,v:int>
-- !query 4 output
two	2


-- !query 5
SELECT t1.* FROM t1, t2 where t1.k = t2.k
EXCEPT
SELECT t1.* FROM t1, t2 where t1.k = t2.k and t1.k != 'one'
-- !query 5 schema
struct<k:string,v:int>
-- !query 5 output
one	1
one	NULL


-- !query 6
SELECT * FROM t2 where v >= 1 and v <> 22 EXCEPT SELECT * FROM t1
-- !query 6 schema
struct<k:string,v:int>
-- !query 6 output
NULL	5
one	5


-- !query 7
SELECT (SELECT min(k) FROM t2 WHERE t2.k = t1.k) min_t2 FROM t1
MINUS
SELECT (SELECT min(k) FROM t2) abs_min_t2 FROM t1 WHERE  t1.k = 'one'
-- !query 7 schema
struct<min_t2:string>
-- !query 7 output
NULL
two


-- !query 8
SELECT t1.k
FROM   t1
WHERE  t1.v <= (SELECT   max(t2.v)
                FROM     t2
                WHERE    t2.k = t1.k)
MINUS
SELECT t1.k
FROM   t1
WHERE  t1.v >= (SELECT   min(t2.v)
                FROM     t2
                WHERE    t2.k = t1.k)
-- !query 8 schema
struct<k:string>
-- !query 8 output
two


-- !query 9
SELECT * FROM t1 EXCEPT ALL SELECT * FROM t2
-- !query 9 schema
struct<k:string,v:int>
-- !query 9 output
three	3
two	2


-- !query 10
SELECT * FROM t1 EXCEPT ALL SELECT * FROM t1 where v <> 1 and v <> 2
-- !query 10 schema
struct<k:string,v:int>
-- !query 10 output
one	1
one	NULL
two	2


-- !query 11
SELECT * FROM t1 where v <> 1 and v <> 22
EXCEPT ALL
SELECT * FROM t1 where v <> 2 and v >= 3
-- !query 11 schema
struct<k:string,v:int>
-- !query 11 output
two	2


-- !query 12
SELECT t1.* FROM t1, t2 where t1.k = t2.k
EXCEPT ALL
SELECT t1.* FROM t1, t2 where t1.k = t2.k and t1.k != 'one'
-- !query 12 schema
struct<k:string,v:int>
-- !query 12 output
one	1
one	1
one	1
one	NULL
one	NULL
one	NULL


-- !query 13
SELECT * FROM t2 where v >= 1 and v <> 22 EXCEPT ALL SELECT * FROM t1
-- !query 13 schema
struct<k:string,v:int>
-- !query 13 output
NULL	5
one	5


-- !query 14
SELECT (SELECT min(k) FROM t2 WHERE t2.k = t1.k) min_t2 FROM t1
MINUS ALL
SELECT (SELECT min(k) FROM t2) abs_min_t2 FROM t1 WHERE  t1.k = 'one'
-- !query 14 schema
struct<min_t2:string>
-- !query 14 output
NULL
two


-- !query 15
SELECT t1.k
FROM   t1
WHERE  t1.v <= (SELECT   max(t2.v)
                FROM     t2
                WHERE    t2.k = t1.k)
MINUS ALL
SELECT t1.k
FROM   t1
WHERE  t1.v >= (SELECT   min(t2.v)
                FROM     t2
                WHERE    t2.k = t1.k)
-- !query 15 schema
struct<k:string>
-- !query 15 output
two


-- !query 16
create temporary view m1 as select * from values
  (1, map(1, "a", 2, "b")),
  (2, map(3, "c", 4, "d"))
  as m1(k, v)
-- !query 16 schema
struct<>
-- !query 16 output



-- !query 17
create temporary view m2 as select * from values
  (2, map(3, "c", 4, "d"))
  as m2(k, v)
-- !query 17 schema
struct<>
-- !query 17 output



-- !query 18
SELECT * FROM m1 EXCEPT ALL SELECT * FROM m2
-- !query 18 schema
struct<>
-- !query 18 output
org.apache.spark.sql.AnalysisException
Cannot have map type columns in DataFrame which calls set operations(intersect, except, etc.), but the type of column v is map<int,string>;
