TakeOrderedAndProject(limit=100, orderBy=[substring(w_warehouse_name, 1, 20)#0 ASC NULLS FIRST,sm_type#0 ASC NULLS FIRST,cc_name#0 ASC NULLS FIRST], output=[substring(w_warehouse_name, 1, 20)#0,sm_type#0,cc_name#0,30 days #0L,31 - 60 days #0L,61 - 90 days #0L,91 - 120 days #0L,>120 days #0L])
+- *HashAggregate(keys=[substring(w_warehouse_name#0, 1, 20)#0, sm_type#0, cc_name#0], functions=[sum(cast(CASE WHEN ((cs_ship_date_sk#0 - cs_sold_date_sk#0) <= 30) THEN 1 ELSE 0 END as bigint)), sum(cast(CASE WHEN (((cs_ship_date_sk#0 - cs_sold_date_sk#0) > 30) && ((cs_ship_date_sk#0 - cs_sold_date_sk#0) <= 60)) THEN 1 ELSE 0 END as bigint)), sum(cast(CASE WHEN (((cs_ship_date_sk#0 - cs_sold_date_sk#0) > 60) && ((cs_ship_date_sk#0 - cs_sold_date_sk#0) <= 90)) THEN 1 ELSE 0 END as bigint)), sum(cast(CASE WHEN (((cs_ship_date_sk#0 - cs_sold_date_sk#0) > 90) && ((cs_ship_date_sk#0 - cs_sold_date_sk#0) <= 120)) THEN 1 ELSE 0 END as bigint)), sum(cast(CASE WHEN ((cs_ship_date_sk#0 - cs_sold_date_sk#0) > 120) THEN 1 ELSE 0 END as bigint))])
   +- Exchange hashpartitioning(substring(w_warehouse_name#0, 1, 20)#0, sm_type#0, cc_name#0, 5)
      +- *HashAggregate(keys=[substring(w_warehouse_name#0, 1, 20) AS none#0, sm_type#0, cc_name#0], functions=[partial_sum(cast(CASE WHEN ((cs_ship_date_sk#0 - cs_sold_date_sk#0) <= 30) THEN 1 ELSE 0 END as bigint)), partial_sum(cast(CASE WHEN (((cs_ship_date_sk#0 - cs_sold_date_sk#0) > 30) && ((cs_ship_date_sk#0 - cs_sold_date_sk#0) <= 60)) THEN 1 ELSE 0 END as bigint)), partial_sum(cast(CASE WHEN (((cs_ship_date_sk#0 - cs_sold_date_sk#0) > 60) && ((cs_ship_date_sk#0 - cs_sold_date_sk#0) <= 90)) THEN 1 ELSE 0 END as bigint)), partial_sum(cast(CASE WHEN (((cs_ship_date_sk#0 - cs_sold_date_sk#0) > 90) && ((cs_ship_date_sk#0 - cs_sold_date_sk#0) <= 120)) THEN 1 ELSE 0 END as bigint)), partial_sum(cast(CASE WHEN ((cs_ship_date_sk#0 - cs_sold_date_sk#0) > 120) THEN 1 ELSE 0 END as bigint))])
         +- *Project [sm_type#0, cc_name#0, cs_sold_date_sk#0, w_warehouse_name#0, cs_ship_date_sk#0]
            +- *BroadcastHashJoin [cs_ship_date_sk#0], [d_date_sk#0], Inner, BuildRight
               :- *Project [sm_type#0, cc_name#0, cs_sold_date_sk#0, w_warehouse_name#0, cs_ship_date_sk#0]
               :  +- *BroadcastHashJoin [cs_call_center_sk#0], [cc_call_center_sk#0], Inner, BuildRight
               :     :- *Project [sm_type#0, cs_call_center_sk#0, cs_sold_date_sk#0, w_warehouse_name#0, cs_ship_date_sk#0]
               :     :  +- *BroadcastHashJoin [cs_ship_mode_sk#0], [sm_ship_mode_sk#0], Inner, BuildRight
               :     :     :- *Project [cs_call_center_sk#0, cs_ship_mode_sk#0, cs_sold_date_sk#0, w_warehouse_name#0, cs_ship_date_sk#0]
               :     :     :  +- *BroadcastHashJoin [cs_warehouse_sk#0], [w_warehouse_sk#0], Inner, BuildRight
               :     :     :     :- *Project [cs_call_center_sk#0, cs_ship_mode_sk#0, cs_warehouse_sk#0, cs_sold_date_sk#0, cs_ship_date_sk#0]
               :     :     :     :  +- *Filter (((isnotnull(cs_call_center_sk#0) && isnotnull(cs_warehouse_sk#0)) && isnotnull(cs_ship_date_sk#0)) && isnotnull(cs_ship_mode_sk#0))
               :     :     :     :     +- *FileScan parquet default.catalog_sales[cs_sold_date_sk#0,cs_ship_date_sk#0,cs_call_center_sk#0,cs_ship_mode_sk#0,cs_warehouse_sk#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,cs_wareh...
               :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
               :     :     :        +- *Project [w_warehouse_sk#0, w_warehouse_name#0]
               :     :     :           +- *Filter isnotnull(w_warehouse_sk#0)
               :     :     :              +- *FileScan parquet default.warehouse[w_warehouse_sk#0,w_warehouse_name#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,w_warehouse_name:string>
               :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
               :     :        +- *Project [sm_type#0, sm_ship_mode_sk#0]
               :     :           +- *Filter isnotnull(sm_ship_mode_sk#0)
               :     :              +- *FileScan parquet default.ship_mode[sm_ship_mode_sk#0,sm_type#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,sm_type:string>
               :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
               :        +- *Project [cc_name#0, cc_call_center_sk#0]
               :           +- *Filter isnotnull(cc_call_center_sk#0)
               :              +- *FileScan parquet default.call_center[cc_call_center_sk#0,cc_name#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,cc_name:string>
               +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                  +- *Project [d_date_sk#0]
                     +- *Filter (((isnotnull(d_date_sk#0) && (1211 >= d_month_seq#0)) && isnotnull(d_month_seq#0)) && (1200 <= d_month_seq#0))
                        +- *FileScan parquet default.date_dim[d_date_sk#0,d_month_seq#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,d_month_seq:int>
