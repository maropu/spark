TakeOrderedAndProject(limit=100, orderBy=[c_customer_id#0 ASC NULLS FIRST,c_salutation#0 ASC NULLS FIRST,c_first_name#0 ASC NULLS FIRST,c_last_name#0 ASC NULLS FIRST,ca_street_number#0 ASC NULLS FIRST,ca_street_name#0 ASC NULLS FIRST,ca_street_type#0 ASC NULLS FIRST,ca_suite_number#0 ASC NULLS FIRST,ca_city#0 ASC NULLS FIRST,ca_county#0 ASC NULLS FIRST,ca_state#0 ASC NULLS FIRST,ca_zip#0 ASC NULLS FIRST,ca_country#0 ASC NULLS FIRST,ca_gmt_offset#0 ASC NULLS FIRST,ca_location_type#0 ASC NULLS FIRST,ctr_total_return#0 ASC NULLS FIRST], output=[c_customer_id#0,c_salutation#0,c_first_name#0,c_last_name#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0,ctr_total_return#0])
+- *Project [ca_street_number#0, ca_street_name#0, c_last_name#0, ca_location_type#0, ca_county#0, ca_suite_number#0, ca_zip#0, c_customer_id#0, ca_state#0, c_salutation#0, ca_city#0, ctr_total_return#0, ca_street_type#0, c_first_name#0, ca_country#0, ca_gmt_offset#0]
   +- *BroadcastHashJoin [c_current_addr_sk#0], [ca_address_sk#0], Inner, BuildRight
      :- *Project [c_current_addr_sk#0, c_first_name#0, c_last_name#0, c_customer_id#0, ctr_total_return#0, c_salutation#0]
      :  +- *BroadcastHashJoin [ctr_customer_sk#0], [c_customer_sk#0], Inner, BuildRight
      :     :- *Project [ctr_customer_sk#0, ctr_total_return#0]
      :     :  +- *BroadcastHashJoin [ctr_state#0], [ctr_state#0#0], Inner, BuildRight, (cast(ctr_total_return#0 as decimal(24,7)) > (CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#0)
      :     :     :- *Filter isnotnull(ctr_total_return#0)
      :     :     :  +- *HashAggregate(keys=[cr_returning_customer_sk#0, ca_state#0], functions=[sum(UnscaledValue(cr_return_amt_inc_tax#0))])
      :     :     :     +- Exchange hashpartitioning(cr_returning_customer_sk#0, ca_state#0, 5)
      :     :     :        +- *HashAggregate(keys=[cr_returning_customer_sk#0, ca_state#0], functions=[partial_sum(UnscaledValue(cr_return_amt_inc_tax#0))])
      :     :     :           +- *Project [cr_returning_customer_sk#0, cr_return_amt_inc_tax#0, ca_state#0]
      :     :     :              +- *BroadcastHashJoin [cr_returning_addr_sk#0], [ca_address_sk#0], Inner, BuildRight
      :     :     :                 :- *Project [cr_returning_customer_sk#0, cr_returning_addr_sk#0, cr_return_amt_inc_tax#0]
      :     :     :                 :  +- *BroadcastHashJoin [cr_returned_date_sk#0], [d_date_sk#0], Inner, BuildRight
      :     :     :                 :     :- *Project [cr_returning_customer_sk#0, cr_returning_addr_sk#0, cr_returned_date_sk#0, cr_return_amt_inc_tax#0]
      :     :     :                 :     :  +- *Filter ((isnotnull(cr_returned_date_sk#0) && isnotnull(cr_returning_addr_sk#0)) && isnotnull(cr_returning_customer_sk#0))
      :     :     :                 :     :     +- *FileScan parquet default.catalog_returns[cr_returned_date_sk#0,cr_returning_customer_sk#0,cr_returning_addr_sk#0,cr_return_amt_inc_tax#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,cr_return_am...
      :     :     :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
      :     :     :                 :        +- *Project [d_date_sk#0]
      :     :     :                 :           +- *Filter ((isnotnull(d_date_sk#0) && isnotnull(d_year#0)) && (2000 = d_year#0))
      :     :     :                 :              +- *FileScan parquet default.date_dim[d_date_sk#0,d_year#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,d_year:int>
      :     :     :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
      :     :     :                    +- *Project [ca_address_sk#0, ca_state#0]
      :     :     :                       +- *Filter (isnotnull(ca_state#0) && isnotnull(ca_address_sk#0))
      :     :     :                          +- *FileScan parquet default.customer_address[ca_address_sk#0,ca_state#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,ca_state:string>
      :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[1, string, true]))
      :     :        +- *Filter isnotnull((CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#0)
      :     :           +- *HashAggregate(keys=[ctr_state#0], functions=[avg(ctr_total_return#0)])
      :     :              +- Exchange hashpartitioning(ctr_state#0, 5)
      :     :                 +- *HashAggregate(keys=[ctr_state#0], functions=[partial_avg(ctr_total_return#0)])
      :     :                    +- *HashAggregate(keys=[cr_returning_customer_sk#0, ca_state#0], functions=[sum(UnscaledValue(cr_return_amt_inc_tax#0))])
      :     :                       +- Exchange hashpartitioning(cr_returning_customer_sk#0, ca_state#0, 5)
      :     :                          +- *HashAggregate(keys=[cr_returning_customer_sk#0, ca_state#0], functions=[partial_sum(UnscaledValue(cr_return_amt_inc_tax#0))])
      :     :                             +- *Project [cr_returning_customer_sk#0, cr_return_amt_inc_tax#0, ca_state#0]
      :     :                                +- *BroadcastHashJoin [cr_returning_addr_sk#0], [ca_address_sk#0], Inner, BuildRight
      :     :                                   :- *Project [cr_returning_customer_sk#0, cr_returning_addr_sk#0, cr_return_amt_inc_tax#0]
      :     :                                   :  +- *BroadcastHashJoin [cr_returned_date_sk#0], [d_date_sk#0], Inner, BuildRight
      :     :                                   :     :- *Project [cr_returning_customer_sk#0, cr_returning_addr_sk#0, cr_returned_date_sk#0, cr_return_amt_inc_tax#0]
      :     :                                   :     :  +- *Filter (isnotnull(cr_returned_date_sk#0) && isnotnull(cr_returning_addr_sk#0))
      :     :                                   :     :     +- *FileScan parquet default.catalog_returns[cr_returned_date_sk#0,cr_returning_customer_sk#0,cr_returning_addr_sk#0,cr_return_amt_inc_tax#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,cr_return_am...
      :     :                                   :     +- ReusedExchange [d_date_sk#0], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
      :     :                                   +- ReusedExchange [ca_address_sk#0, ca_state#0], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
      :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
      :        +- *Project [c_current_addr_sk#0, c_first_name#0, c_last_name#0, c_customer_sk#0, c_customer_id#0, c_salutation#0]
      :           +- *Filter (isnotnull(c_current_addr_sk#0) && isnotnull(c_customer_sk#0))
      :              +- *FileScan parquet default.customer[c_customer_sk#0,c_customer_id#0,c_current_addr_sk#0,c_salutation#0,c_first_name#0,c_last_name#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,c_first_n...
      +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
         +- *Project [ca_city#0, ca_street_type#0, ca_address_sk#0, ca_country#0, ca_gmt_offset#0, ca_street_number#0, ca_street_name#0, ca_location_type#0, ca_county#0, ca_suite_number#0, ca_zip#0, ca_state#0]
            +- *Filter (((GA = ca_state#0) && isnotnull(ca_state#0)) && isnotnull(ca_address_sk#0))
               +- *FileScan parquet default.customer_address[ca_address_sk#0,ca_street_number#0,ca_street_name#0,ca_street_type#0,ca_suite_number#0,ca_city#0,ca_county#0,ca_state#0,ca_zip#0,ca_country#0,ca_gmt_offset#0,ca_location_type#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,ca_s...
