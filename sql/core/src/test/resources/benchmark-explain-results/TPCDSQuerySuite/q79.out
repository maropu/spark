TakeOrderedAndProject(limit=100, orderBy=[c_last_name#0 ASC NULLS FIRST,c_first_name#0 ASC NULLS FIRST,substring(s_city#0, 1, 30) ASC NULLS FIRST,profit#0 ASC NULLS FIRST], output=[c_last_name#0,c_first_name#0,substring(s_city, 1, 30)#0,ss_ticket_number#0,amt#0,profit#0])
+- *Project [c_last_name#0, profit#0, ss_ticket_number#0, substring(s_city#0, 1, 30) AS none#0, amt#0, s_city#0, c_first_name#0]
   +- *BroadcastHashJoin [ss_customer_sk#0], [c_customer_sk#0], Inner, BuildRight
      :- *HashAggregate(keys=[ss_ticket_number#0, ss_customer_sk#0, ss_addr_sk#0, s_city#0], functions=[sum(UnscaledValue(ss_coupon_amt#0)), sum(UnscaledValue(ss_net_profit#0))])
      :  +- Exchange hashpartitioning(ss_ticket_number#0, ss_customer_sk#0, ss_addr_sk#0, s_city#0, 5)
      :     +- *HashAggregate(keys=[ss_ticket_number#0, ss_customer_sk#0, ss_addr_sk#0, s_city#0], functions=[partial_sum(UnscaledValue(ss_coupon_amt#0)), partial_sum(UnscaledValue(ss_net_profit#0))])
      :        +- *Project [s_city#0, ss_ticket_number#0, ss_coupon_amt#0, ss_net_profit#0, ss_customer_sk#0, ss_addr_sk#0]
      :           +- *BroadcastHashJoin [ss_hdemo_sk#0], [hd_demo_sk#0], Inner, BuildRight
      :              :- *Project [s_city#0, ss_hdemo_sk#0, ss_ticket_number#0, ss_coupon_amt#0, ss_net_profit#0, ss_customer_sk#0, ss_addr_sk#0]
      :              :  +- *BroadcastHashJoin [ss_store_sk#0], [s_store_sk#0], Inner, BuildRight
      :              :     :- *Project [ss_hdemo_sk#0, ss_ticket_number#0, ss_store_sk#0, ss_coupon_amt#0, ss_net_profit#0, ss_customer_sk#0, ss_addr_sk#0]
      :              :     :  +- *BroadcastHashJoin [ss_sold_date_sk#0], [d_date_sk#0], Inner, BuildRight
      :              :     :     :- *Project [ss_hdemo_sk#0, ss_ticket_number#0, ss_store_sk#0, ss_sold_date_sk#0, ss_coupon_amt#0, ss_net_profit#0, ss_customer_sk#0, ss_addr_sk#0]
      :              :     :     :  +- *Filter (((isnotnull(ss_hdemo_sk#0) && isnotnull(ss_customer_sk#0)) && isnotnull(ss_store_sk#0)) && isnotnull(ss_sold_date_sk#0))
      :              :     :     :     +- *FileScan parquet default.store_sales[ss_sold_date_sk#0,ss_customer_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_ticket_number#0,ss_coupon_amt#0,ss_net_profit#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,ss_t...
      :              :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
      :              :     :        +- *Project [d_date_sk#0]
      :              :     :           +- *Filter (((isnotnull(d_date_sk#0) && isnotnull(d_dow#0)) && (1 = d_dow#0)) && d_year#0 IN (1999,2000,2001))
      :              :     :              +- *FileScan parquet default.date_dim[d_date_sk#0,d_year#0,d_dow#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,d_dow:int>
      :              :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
      :              :        +- *Project [s_city#0, s_store_sk#0]
      :              :           +- *Filter ((((200 <= s_number_employees#0) && isnotnull(s_number_employees#0)) && isnotnull(s_store_sk#0)) && (295 >= s_number_employees#0))
      :              :              +- *FileScan parquet default.store[s_store_sk#0,s_number_employees#0,s_city#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,s_city:string>
      :              +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
      :                 +- *Project [hd_demo_sk#0]
      :                    +- *Filter (isnotnull(hd_demo_sk#0) && ((hd_dep_count#0 = 6) || (2 < hd_vehicle_count#0)))
      :                       +- *FileScan parquet default.household_demographics[hd_demo_sk#0,hd_dep_count#0,hd_vehicle_count#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,hd_vehicle_count:int>
      +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
         +- *Project [c_first_name#0, c_last_name#0, c_customer_sk#0]
            +- *Filter isnotnull(c_customer_sk#0)
               +- *FileScan parquet default.customer[c_customer_sk#0,c_first_name#0,c_last_name#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,c_last_name:string>
