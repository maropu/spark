TakeOrderedAndProject(limit=100, orderBy=[channel#0 ASC NULLS FIRST,col_name#0 ASC NULLS FIRST,d_year#0 ASC NULLS FIRST,d_qoy#0 ASC NULLS FIRST,i_category#0 ASC NULLS FIRST], output=[channel#0,col_name#0,d_year#0,d_qoy#0,i_category#0,sales_cnt#0L,sales_amt#0])
+- *HashAggregate(keys=[channel#0, col_name#0, d_year#0, d_qoy#0, i_category#0], functions=[count(1), sum(UnscaledValue(ext_sales_price#0))])
   +- Exchange hashpartitioning(channel#0, col_name#0, d_year#0, d_qoy#0, i_category#0, 5)
      +- *HashAggregate(keys=[channel#0, col_name#0, d_year#0, d_qoy#0, i_category#0], functions=[partial_count(1), partial_sum(UnscaledValue(ext_sales_price#0))])
         +- Union
            :- *Project [ss_ext_sales_price#0 AS none#0, i_category#0, d_qoy#0, ss_store_sk#0 AS none#0, store AS none#0, d_year#0]
            :  +- *BroadcastHashJoin [ss_sold_date_sk#0], [d_date_sk#0], Inner, BuildRight
            :     :- *Project [ss_store_sk#0, ss_sold_date_sk#0, ss_ext_sales_price#0, i_category#0]
            :     :  +- *BroadcastHashJoin [ss_item_sk#0], [i_item_sk#0], Inner, BuildRight
            :     :     :- *Project [ss_item_sk#0, ss_store_sk#0, ss_sold_date_sk#0, ss_ext_sales_price#0]
            :     :     :  +- *Filter ((isnotnull(ss_item_sk#0) && isnull(ss_store_sk#0)) && isnotnull(ss_sold_date_sk#0))
            :     :     :     +- *FileScan parquet default.store_sales[ss_sold_date_sk#0,ss_item_sk#0,ss_store_sk#0,ss_ext_sales_price#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,2)>
            :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
            :     :        +- *Project [i_item_sk#0, i_category#0]
            :     :           +- *Filter isnotnull(i_item_sk#0)
            :     :              +- *FileScan parquet default.item[i_item_sk#0,i_category#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,i_category:string>
            :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
            :        +- *Project [d_date_sk#0, d_year#0, d_qoy#0]
            :           +- *Filter isnotnull(d_date_sk#0)
            :              +- *FileScan parquet default.date_dim[d_date_sk#0,d_year#0,d_qoy#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,d_qoy:int>
            :- *Project [ws_ship_customer_sk#0 AS none#0, i_category#0, d_qoy#0, d_year#0, ws_ext_sales_price#0 AS none#0, web AS none#0]
            :  +- *BroadcastHashJoin [ws_sold_date_sk#0], [d_date_sk#0], Inner, BuildRight
            :     :- *Project [ws_sold_date_sk#0, ws_ext_sales_price#0, ws_ship_customer_sk#0, i_category#0]
            :     :  +- *BroadcastHashJoin [ws_item_sk#0], [i_item_sk#0], Inner, BuildRight
            :     :     :- *Project [ws_item_sk#0, ws_sold_date_sk#0, ws_ext_sales_price#0, ws_ship_customer_sk#0]
            :     :     :  +- *Filter ((isnotnull(ws_item_sk#0) && isnull(ws_ship_customer_sk#0)) && isnotnull(ws_sold_date_sk#0))
            :     :     :     +- *FileScan parquet default.web_sales[ws_sold_date_sk#0,ws_item_sk#0,ws_ship_customer_sk#0,ws_ext_sales_price#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,2)>
            :     :     +- ReusedExchange [i_item_sk#0, i_category#0], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
            :     +- ReusedExchange [d_date_sk#0, d_year#0, d_qoy#0], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
            +- *Project [i_category#0, d_qoy#0, cs_ship_addr_sk#0 AS none#0, catalog AS none#0, cs_ext_sales_price#0 AS none#0, d_year#0]
               +- *BroadcastHashJoin [cs_sold_date_sk#0], [d_date_sk#0], Inner, BuildRight
                  :- *Project [cs_ship_addr_sk#0, cs_ext_sales_price#0, cs_sold_date_sk#0, i_category#0]
                  :  +- *BroadcastHashJoin [cs_item_sk#0], [i_item_sk#0], Inner, BuildRight
                  :     :- *Project [cs_ship_addr_sk#0, cs_ext_sales_price#0, cs_sold_date_sk#0, cs_item_sk#0]
                  :     :  +- *Filter ((isnotnull(cs_sold_date_sk#0) && isnull(cs_ship_addr_sk#0)) && isnotnull(cs_item_sk#0))
                  :     :     +- *FileScan parquet default.catalog_sales[cs_sold_date_sk#0,cs_ship_addr_sk#0,cs_item_sk#0,cs_ext_sales_price#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,2)>
                  :     +- ReusedExchange [i_item_sk#0, i_category#0], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                  +- ReusedExchange [d_date_sk#0, d_year#0, d_qoy#0], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
