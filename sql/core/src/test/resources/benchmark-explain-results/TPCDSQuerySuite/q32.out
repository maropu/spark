CollectLimit 100
+- *LocalLimit 100
   +- *Project [1 AS none#0]
      +- *BroadcastHashJoin [cs_sold_date_sk#0], [d_date_sk#0], Inner, BuildRight
         :- *Project [cs_sold_date_sk#0]
         :  +- *BroadcastHashJoin [i_item_sk#0], [cs_item_sk#0#0], Inner, BuildRight, (cast(cs_ext_discount_amt#0 as decimal(14,7)) > (CAST(1.3 AS DECIMAL(11,6)) * CAST(avg(cs_ext_discount_amt) AS DECIMAL(11,6)))#0)
         :     :- *Project [i_item_sk#0, cs_sold_date_sk#0, cs_ext_discount_amt#0]
         :     :  +- *BroadcastHashJoin [cs_item_sk#0], [i_item_sk#0], Inner, BuildRight
         :     :     :- *Project [cs_sold_date_sk#0, cs_ext_discount_amt#0, cs_item_sk#0]
         :     :     :  +- *Filter ((isnotnull(cs_ext_discount_amt#0) && isnotnull(cs_sold_date_sk#0)) && isnotnull(cs_item_sk#0))
         :     :     :     +- *FileScan parquet default.catalog_sales[cs_sold_date_sk#0,cs_item_sk#0,cs_ext_discount_amt#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,2)>
         :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
         :     :        +- *Project [i_item_sk#0]
         :     :           +- *Filter ((isnotnull(i_manufact_id#0) && (977 = i_manufact_id#0)) && isnotnull(i_item_sk#0))
         :     :              +- *FileScan parquet default.item[i_item_sk#0,i_manufact_id#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,i_manufact_id:int>
         :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[1, int, true] as bigint)))
         :        +- *Filter isnotnull((CAST(1.3 AS DECIMAL(11,6)) * CAST(avg(cs_ext_discount_amt) AS DECIMAL(11,6)))#0)
         :           +- *HashAggregate(keys=[cs_item_sk#0], functions=[avg(UnscaledValue(cs_ext_discount_amt#0))])
         :              +- Exchange hashpartitioning(cs_item_sk#0, 5)
         :                 +- *HashAggregate(keys=[cs_item_sk#0], functions=[partial_avg(UnscaledValue(cs_ext_discount_amt#0))])
         :                    +- *Project [cs_ext_discount_amt#0, cs_item_sk#0]
         :                       +- *BroadcastHashJoin [cs_sold_date_sk#0], [d_date_sk#0], Inner, BuildRight
         :                          :- *Project [cs_sold_date_sk#0, cs_ext_discount_amt#0, cs_item_sk#0]
         :                          :  +- *Filter (isnotnull(cs_sold_date_sk#0) && isnotnull(cs_item_sk#0))
         :                          :     +- *FileScan parquet default.catalog_sales[cs_sold_date_sk#0,cs_item_sk#0,cs_ext_discount_amt#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,2)>
         :                          +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
         :                             +- *Project [d_date_sk#0]
         :                                +- *Filter (((isnotnull(d_date_sk#0) && isnotnull(d_date#0)) && (2000-01-27] <= d_date#0)) && (2000-04-26 >= d_date#0))
         :                                   +- *FileScan parquet default.date_dim[d_date_sk#0,d_date#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,d_date:string>
         +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
            +- *Project [d_date_sk#0]
               +- *Filter (((isnotnull(d_date_sk#0) && (d_date#0 >= 2000-01-27)) && isnotnull(d_date#0)) && (2000-04-26 >= d_date#0))
                  +- *FileScan parquet default.date_dim[d_date_sk#0,d_date#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,d_date:string>
