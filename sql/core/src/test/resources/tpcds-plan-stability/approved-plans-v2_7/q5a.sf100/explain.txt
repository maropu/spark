== Physical Plan ==
TakeOrderedAndProject (98)
+- * HashAggregate (97)
   +- Exchange (96)
      +- * HashAggregate (95)
         +- Union (94)
            :- * HashAggregate (88)
            :  +- Exchange (87)
            :     +- * HashAggregate (86)
            :        +- Union (85)
            :           :- * HashAggregate (79)
            :           :  +- Exchange (78)
            :           :     +- * HashAggregate (77)
            :           :        +- Union (76)
            :           :           :- * HashAggregate (25)
            :           :           :  +- Exchange (24)
            :           :           :     +- * HashAggregate (23)
            :           :           :        +- * Project (22)
            :           :           :           +- * BroadcastHashJoin Inner BuildRight (21)
            :           :           :              :- * Project (16)
            :           :           :              :  +- * BroadcastHashJoin Inner BuildRight (15)
            :           :           :              :     :- Union (9)
            :           :           :              :     :  :- * Project (4)
            :           :           :              :     :  :  +- * Filter (3)
            :           :           :              :     :  :     +- * ColumnarToRow (2)
            :           :           :              :     :  :        +- Scan parquet default.store_sales (1)
            :           :           :              :     :  +- * Project (8)
            :           :           :              :     :     +- * Filter (7)
            :           :           :              :     :        +- * ColumnarToRow (6)
            :           :           :              :     :           +- Scan parquet default.store_returns (5)
            :           :           :              :     +- BroadcastExchange (14)
            :           :           :              :        +- * Project (13)
            :           :           :              :           +- * Filter (12)
            :           :           :              :              +- * ColumnarToRow (11)
            :           :           :              :                 +- Scan parquet default.date_dim (10)
            :           :           :              +- BroadcastExchange (20)
            :           :           :                 +- * Filter (19)
            :           :           :                    +- * ColumnarToRow (18)
            :           :           :                       +- Scan parquet default.store (17)
            :           :           :- * HashAggregate (46)
            :           :           :  +- Exchange (45)
            :           :           :     +- * HashAggregate (44)
            :           :           :        +- * Project (43)
            :           :           :           +- * BroadcastHashJoin Inner BuildRight (42)
            :           :           :              :- * Project (37)
            :           :           :              :  +- * BroadcastHashJoin Inner BuildRight (36)
            :           :           :              :     :- Union (34)
            :           :           :              :     :  :- * Project (29)
            :           :           :              :     :  :  +- * Filter (28)
            :           :           :              :     :  :     +- * ColumnarToRow (27)
            :           :           :              :     :  :        +- Scan parquet default.catalog_sales (26)
            :           :           :              :     :  +- * Project (33)
            :           :           :              :     :     +- * Filter (32)
            :           :           :              :     :        +- * ColumnarToRow (31)
            :           :           :              :     :           +- Scan parquet default.catalog_returns (30)
            :           :           :              :     +- ReusedExchange (35)
            :           :           :              +- BroadcastExchange (41)
            :           :           :                 +- * Filter (40)
            :           :           :                    +- * ColumnarToRow (39)
            :           :           :                       +- Scan parquet default.catalog_page (38)
            :           :           +- * HashAggregate (75)
            :           :              +- Exchange (74)
            :           :                 +- * HashAggregate (73)
            :           :                    +- * Project (72)
            :           :                       +- * BroadcastHashJoin Inner BuildRight (71)
            :           :                          :- * Project (66)
            :           :                          :  +- * BroadcastHashJoin Inner BuildRight (65)
            :           :                          :     :- Union (63)
            :           :                          :     :  :- * Project (50)
            :           :                          :     :  :  +- * Filter (49)
            :           :                          :     :  :     +- * ColumnarToRow (48)
            :           :                          :     :  :        +- Scan parquet default.web_sales (47)
            :           :                          :     :  +- * Project (62)
            :           :                          :     :     +- * SortMergeJoin Inner (61)
            :           :                          :     :        :- * Sort (55)
            :           :                          :     :        :  +- Exchange (54)
            :           :                          :     :        :     +- * Filter (53)
            :           :                          :     :        :        +- * ColumnarToRow (52)
            :           :                          :     :        :           +- Scan parquet default.web_returns (51)
            :           :                          :     :        +- * Sort (60)
            :           :                          :     :           +- Exchange (59)
            :           :                          :     :              +- * Filter (58)
            :           :                          :     :                 +- * ColumnarToRow (57)
            :           :                          :     :                    +- Scan parquet default.web_sales (56)
            :           :                          :     +- ReusedExchange (64)
            :           :                          +- BroadcastExchange (70)
            :           :                             +- * Filter (69)
            :           :                                +- * ColumnarToRow (68)
            :           :                                   +- Scan parquet default.web_site (67)
            :           +- * HashAggregate (84)
            :              +- Exchange (83)
            :                 +- * HashAggregate (82)
            :                    +- * HashAggregate (81)
            :                       +- ReusedExchange (80)
            +- * HashAggregate (93)
               +- Exchange (92)
                  +- * HashAggregate (91)
                     +- * HashAggregate (90)
                        +- ReusedExchange (89)


(1) Scan parquet default.store_sales
Output [4]: [ss_sold_date_sk#1, ss_store_sk#2, ss_ext_sales_price#3, ss_net_profit#4]
Batched: true
Location [not included in comparison]/{warehouse_dir}/store_sales]
ReadSchema: struct<ss_sold_date_sk:int,ss_store_sk:int,ss_ext_sales_price:decimal(7,2),ss_net_profit:decimal(7,2)>

(2) ColumnarToRow [codegen id : 1]
Input [4]: [ss_sold_date_sk#1, ss_store_sk#2, ss_ext_sales_price#3, ss_net_profit#4]

(3) Filter [codegen id : 1]
Input [4]: [ss_sold_date_sk#1, ss_store_sk#2, ss_ext_sales_price#3, ss_net_profit#4]
Condition : (isnotnull(cast(ss_sold_date_sk#1 as bigint)) AND isnotnull(cast(ss_store_sk#2 as bigint)))

(4) Project [codegen id : 1]
Output [6]: [cast(ss_store_sk#2 as bigint) AS store_sk#5, cast(ss_sold_date_sk#1 as bigint) AS date_sk#6, ss_ext_sales_price#3 AS sales_price#7, ss_net_profit#4 AS profit#8, 0.00 AS return_amt#9, 0.00 AS net_loss#10]
Input [4]: [ss_sold_date_sk#1, ss_store_sk#2, ss_ext_sales_price#3, ss_net_profit#4]

(5) Scan parquet default.store_returns
Output [4]: [sr_returned_date_sk#11, sr_store_sk#12, sr_return_amt#13, sr_net_loss#14]
Batched: true
Location [not included in comparison]/{warehouse_dir}/store_returns]
PushedFilters: [IsNotNull(sr_returned_date_sk), IsNotNull(sr_store_sk)]
ReadSchema: struct<sr_returned_date_sk:bigint,sr_store_sk:bigint,sr_return_amt:decimal(7,2),sr_net_loss:decimal(7,2)>

(6) ColumnarToRow [codegen id : 2]
Input [4]: [sr_returned_date_sk#11, sr_store_sk#12, sr_return_amt#13, sr_net_loss#14]

(7) Filter [codegen id : 2]
Input [4]: [sr_returned_date_sk#11, sr_store_sk#12, sr_return_amt#13, sr_net_loss#14]
Condition : (isnotnull(sr_returned_date_sk#11) AND isnotnull(sr_store_sk#12))

(8) Project [codegen id : 2]
Output [6]: [sr_store_sk#12 AS store_sk#15, sr_returned_date_sk#11 AS date_sk#16, 0.00 AS sales_price#17, 0.00 AS profit#18, sr_return_amt#13 AS return_amt#19, sr_net_loss#14 AS net_loss#20]
Input [4]: [sr_returned_date_sk#11, sr_store_sk#12, sr_return_amt#13, sr_net_loss#14]

(9) Union
Arguments: [store_sk#21, date_sk#22, sales_price#23, profit#24, return_amt#25, net_loss#26]

(10) Scan parquet default.date_dim
Output [2]: [d_date_sk#27, d_date#28]
Batched: true
Location [not included in comparison]/{warehouse_dir}/date_dim]
PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,1998-08-04), LessThanOrEqual(d_date,1998-08-18), IsNotNull(d_date_sk)]
ReadSchema: struct<d_date_sk:int,d_date:date>

(11) ColumnarToRow [codegen id : 3]
Input [2]: [d_date_sk#27, d_date#28]

(12) Filter [codegen id : 3]
Input [2]: [d_date_sk#27, d_date#28]
Condition : (((isnotnull(d_date#28) AND (d_date#28 >= 10442)) AND (d_date#28 <= 10456)) AND isnotnull(d_date_sk#27))

(13) Project [codegen id : 3]
Output [1]: [d_date_sk#27]
Input [2]: [d_date_sk#27, d_date#28]

(14) BroadcastExchange
Input [1]: [d_date_sk#27]
Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#29]

(15) BroadcastHashJoin [codegen id : 5]
Left keys [1]: [date_sk#22]
Right keys [1]: [cast(d_date_sk#27 as bigint)]
Join condition: None

(16) Project [codegen id : 5]
Output [5]: [store_sk#21, sales_price#23, profit#24, return_amt#25, net_loss#26]
Input [7]: [store_sk#21, date_sk#22, sales_price#23, profit#24, return_amt#25, net_loss#26, d_date_sk#27]

(17) Scan parquet default.store
Output [2]: [s_store_sk#30, s_store_id#31]
Batched: true
Location [not included in comparison]/{warehouse_dir}/store]
PushedFilters: [IsNotNull(s_store_sk)]
ReadSchema: struct<s_store_sk:int,s_store_id:string>

(18) ColumnarToRow [codegen id : 4]
Input [2]: [s_store_sk#30, s_store_id#31]

(19) Filter [codegen id : 4]
Input [2]: [s_store_sk#30, s_store_id#31]
Condition : isnotnull(s_store_sk#30)

(20) BroadcastExchange
Input [2]: [s_store_sk#30, s_store_id#31]
Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#32]

(21) BroadcastHashJoin [codegen id : 5]
Left keys [1]: [store_sk#21]
Right keys [1]: [cast(s_store_sk#30 as bigint)]
Join condition: None

(22) Project [codegen id : 5]
Output [5]: [sales_price#23, profit#24, return_amt#25, net_loss#26, s_store_id#31]
Input [7]: [store_sk#21, sales_price#23, profit#24, return_amt#25, net_loss#26, s_store_sk#30, s_store_id#31]

(23) HashAggregate [codegen id : 5]
Input [5]: [sales_price#23, profit#24, return_amt#25, net_loss#26, s_store_id#31]
Keys [1]: [s_store_id#31]
Functions [4]: [partial_sum(UnscaledValue(sales_price#23)), partial_sum(UnscaledValue(return_amt#25)), partial_sum(UnscaledValue(profit#24)), partial_sum(UnscaledValue(net_loss#26))]
Aggregate Attributes [4]: [sum#33, sum#34, sum#35, sum#36]
Results [5]: [s_store_id#31, sum#37, sum#38, sum#39, sum#40]

(24) Exchange
Input [5]: [s_store_id#31, sum#37, sum#38, sum#39, sum#40]
Arguments: hashpartitioning(s_store_id#31, 5), true, [id=#41]

(25) HashAggregate [codegen id : 6]
Input [5]: [s_store_id#31, sum#37, sum#38, sum#39, sum#40]
Keys [1]: [s_store_id#31]
Functions [4]: [sum(UnscaledValue(sales_price#23)), sum(UnscaledValue(return_amt#25)), sum(UnscaledValue(profit#24)), sum(UnscaledValue(net_loss#26))]
Aggregate Attributes [4]: [sum(UnscaledValue(sales_price#23))#42, sum(UnscaledValue(return_amt#25))#43, sum(UnscaledValue(profit#24))#44, sum(UnscaledValue(net_loss#26))#45]
Results [5]: [store channel AS channel#46, concat(store, s_store_id#31) AS id#47, MakeDecimal(sum(UnscaledValue(sales_price#23))#42,17,2) AS sales#48, MakeDecimal(sum(UnscaledValue(return_amt#25))#43,17,2) AS returns#49, CheckOverflow((promote_precision(cast(MakeDecimal(sum(UnscaledValue(profit#24))#44,17,2) as decimal(18,2))) - promote_precision(cast(MakeDecimal(sum(UnscaledValue(net_loss#26))#45,17,2) as decimal(18,2)))), DecimalType(18,2), true) AS profit#50]

(26) Scan parquet default.catalog_sales
Output [4]: [cs_sold_date_sk#51, cs_catalog_page_sk#52, cs_ext_sales_price#53, cs_net_profit#54]
Batched: true
Location [not included in comparison]/{warehouse_dir}/catalog_sales]
PushedFilters: [IsNotNull(cs_sold_date_sk), IsNotNull(cs_catalog_page_sk)]
ReadSchema: struct<cs_sold_date_sk:int,cs_catalog_page_sk:int,cs_ext_sales_price:decimal(7,2),cs_net_profit:decimal(7,2)>

(27) ColumnarToRow [codegen id : 7]
Input [4]: [cs_sold_date_sk#51, cs_catalog_page_sk#52, cs_ext_sales_price#53, cs_net_profit#54]

(28) Filter [codegen id : 7]
Input [4]: [cs_sold_date_sk#51, cs_catalog_page_sk#52, cs_ext_sales_price#53, cs_net_profit#54]
Condition : (isnotnull(cs_sold_date_sk#51) AND isnotnull(cs_catalog_page_sk#52))

(29) Project [codegen id : 7]
Output [6]: [cs_catalog_page_sk#52 AS page_sk#55, cs_sold_date_sk#51 AS date_sk#56, cs_ext_sales_price#53 AS sales_price#57, cs_net_profit#54 AS profit#58, 0.00 AS return_amt#59, 0.00 AS net_loss#60]
Input [4]: [cs_sold_date_sk#51, cs_catalog_page_sk#52, cs_ext_sales_price#53, cs_net_profit#54]

(30) Scan parquet default.catalog_returns
Output [4]: [cr_returned_date_sk#61, cr_catalog_page_sk#62, cr_return_amount#63, cr_net_loss#64]
Batched: true
Location [not included in comparison]/{warehouse_dir}/catalog_returns]
PushedFilters: [IsNotNull(cr_returned_date_sk), IsNotNull(cr_catalog_page_sk)]
ReadSchema: struct<cr_returned_date_sk:int,cr_catalog_page_sk:int,cr_return_amount:decimal(7,2),cr_net_loss:decimal(7,2)>

(31) ColumnarToRow [codegen id : 8]
Input [4]: [cr_returned_date_sk#61, cr_catalog_page_sk#62, cr_return_amount#63, cr_net_loss#64]

(32) Filter [codegen id : 8]
Input [4]: [cr_returned_date_sk#61, cr_catalog_page_sk#62, cr_return_amount#63, cr_net_loss#64]
Condition : (isnotnull(cr_returned_date_sk#61) AND isnotnull(cr_catalog_page_sk#62))

(33) Project [codegen id : 8]
Output [6]: [cr_catalog_page_sk#62 AS page_sk#65, cr_returned_date_sk#61 AS date_sk#66, 0.00 AS sales_price#67, 0.00 AS profit#68, cr_return_amount#63 AS return_amt#69, cr_net_loss#64 AS net_loss#70]
Input [4]: [cr_returned_date_sk#61, cr_catalog_page_sk#62, cr_return_amount#63, cr_net_loss#64]

(34) Union
Arguments: [page_sk#71, date_sk#72, sales_price#73, profit#74, return_amt#75, net_loss#76]

(35) ReusedExchange [Reuses operator id: 14]
Output [1]: [d_date_sk#27]

(36) BroadcastHashJoin [codegen id : 11]
Left keys [1]: [date_sk#72]
Right keys [1]: [d_date_sk#27]
Join condition: None

(37) Project [codegen id : 11]
Output [5]: [page_sk#71, sales_price#73, profit#74, return_amt#75, net_loss#76]
Input [7]: [page_sk#71, date_sk#72, sales_price#73, profit#74, return_amt#75, net_loss#76, d_date_sk#27]

(38) Scan parquet default.catalog_page
Output [2]: [cp_catalog_page_sk#77, cp_catalog_page_id#78]
Batched: true
Location [not included in comparison]/{warehouse_dir}/catalog_page]
PushedFilters: [IsNotNull(cp_catalog_page_sk)]
ReadSchema: struct<cp_catalog_page_sk:int,cp_catalog_page_id:string>

(39) ColumnarToRow [codegen id : 10]
Input [2]: [cp_catalog_page_sk#77, cp_catalog_page_id#78]

(40) Filter [codegen id : 10]
Input [2]: [cp_catalog_page_sk#77, cp_catalog_page_id#78]
Condition : isnotnull(cp_catalog_page_sk#77)

(41) BroadcastExchange
Input [2]: [cp_catalog_page_sk#77, cp_catalog_page_id#78]
Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#79]

(42) BroadcastHashJoin [codegen id : 11]
Left keys [1]: [page_sk#71]
Right keys [1]: [cp_catalog_page_sk#77]
Join condition: None

(43) Project [codegen id : 11]
Output [5]: [sales_price#73, profit#74, return_amt#75, net_loss#76, cp_catalog_page_id#78]
Input [7]: [page_sk#71, sales_price#73, profit#74, return_amt#75, net_loss#76, cp_catalog_page_sk#77, cp_catalog_page_id#78]

(44) HashAggregate [codegen id : 11]
Input [5]: [sales_price#73, profit#74, return_amt#75, net_loss#76, cp_catalog_page_id#78]
Keys [1]: [cp_catalog_page_id#78]
Functions [4]: [partial_sum(UnscaledValue(sales_price#73)), partial_sum(UnscaledValue(return_amt#75)), partial_sum(UnscaledValue(profit#74)), partial_sum(UnscaledValue(net_loss#76))]
Aggregate Attributes [4]: [sum#80, sum#81, sum#82, sum#83]
Results [5]: [cp_catalog_page_id#78, sum#84, sum#85, sum#86, sum#87]

(45) Exchange
Input [5]: [cp_catalog_page_id#78, sum#84, sum#85, sum#86, sum#87]
Arguments: hashpartitioning(cp_catalog_page_id#78, 5), true, [id=#88]

(46) HashAggregate [codegen id : 12]
Input [5]: [cp_catalog_page_id#78, sum#84, sum#85, sum#86, sum#87]
Keys [1]: [cp_catalog_page_id#78]
Functions [4]: [sum(UnscaledValue(sales_price#73)), sum(UnscaledValue(return_amt#75)), sum(UnscaledValue(profit#74)), sum(UnscaledValue(net_loss#76))]
Aggregate Attributes [4]: [sum(UnscaledValue(sales_price#73))#89, sum(UnscaledValue(return_amt#75))#90, sum(UnscaledValue(profit#74))#91, sum(UnscaledValue(net_loss#76))#92]
Results [5]: [catalog channel AS channel#93, concat(catalog_page, cp_catalog_page_id#78) AS id#94, MakeDecimal(sum(UnscaledValue(sales_price#73))#89,17,2) AS sales#95, MakeDecimal(sum(UnscaledValue(return_amt#75))#90,17,2) AS returns#96, CheckOverflow((promote_precision(cast(MakeDecimal(sum(UnscaledValue(profit#74))#91,17,2) as decimal(18,2))) - promote_precision(cast(MakeDecimal(sum(UnscaledValue(net_loss#76))#92,17,2) as decimal(18,2)))), DecimalType(18,2), true) AS profit#97]

(47) Scan parquet default.web_sales
Output [4]: [ws_sold_date_sk#98, ws_web_site_sk#99, ws_ext_sales_price#100, ws_net_profit#101]
Batched: true
Location [not included in comparison]/{warehouse_dir}/web_sales]
PushedFilters: [IsNotNull(ws_web_site_sk)]
ReadSchema: struct<ws_sold_date_sk:int,ws_web_site_sk:int,ws_ext_sales_price:decimal(7,2),ws_net_profit:decimal(7,2)>

(48) ColumnarToRow [codegen id : 13]
Input [4]: [ws_sold_date_sk#98, ws_web_site_sk#99, ws_ext_sales_price#100, ws_net_profit#101]

(49) Filter [codegen id : 13]
Input [4]: [ws_sold_date_sk#98, ws_web_site_sk#99, ws_ext_sales_price#100, ws_net_profit#101]
Condition : (isnotnull(cast(ws_sold_date_sk#98 as bigint)) AND isnotnull(ws_web_site_sk#99))

(50) Project [codegen id : 13]
Output [6]: [ws_web_site_sk#99 AS wsr_web_site_sk#102, cast(ws_sold_date_sk#98 as bigint) AS date_sk#103, ws_ext_sales_price#100 AS sales_price#104, ws_net_profit#101 AS profit#105, 0.00 AS return_amt#106, 0.00 AS net_loss#107]
Input [4]: [ws_sold_date_sk#98, ws_web_site_sk#99, ws_ext_sales_price#100, ws_net_profit#101]

(51) Scan parquet default.web_returns
Output [5]: [wr_returned_date_sk#108, wr_item_sk#109, wr_order_number#110, wr_return_amt#111, wr_net_loss#112]
Batched: true
Location [not included in comparison]/{warehouse_dir}/web_returns]
PushedFilters: [IsNotNull(wr_returned_date_sk)]
ReadSchema: struct<wr_returned_date_sk:bigint,wr_item_sk:bigint,wr_order_number:bigint,wr_return_amt:decimal(7,2),wr_net_loss:decimal(7,2)>

(52) ColumnarToRow [codegen id : 14]
Input [5]: [wr_returned_date_sk#108, wr_item_sk#109, wr_order_number#110, wr_return_amt#111, wr_net_loss#112]

(53) Filter [codegen id : 14]
Input [5]: [wr_returned_date_sk#108, wr_item_sk#109, wr_order_number#110, wr_return_amt#111, wr_net_loss#112]
Condition : isnotnull(wr_returned_date_sk#108)

(54) Exchange
Input [5]: [wr_returned_date_sk#108, wr_item_sk#109, wr_order_number#110, wr_return_amt#111, wr_net_loss#112]
Arguments: hashpartitioning(wr_item_sk#109, wr_order_number#110, 5), true, [id=#113]

(55) Sort [codegen id : 15]
Input [5]: [wr_returned_date_sk#108, wr_item_sk#109, wr_order_number#110, wr_return_amt#111, wr_net_loss#112]
Arguments: [wr_item_sk#109 ASC NULLS FIRST, wr_order_number#110 ASC NULLS FIRST], false, 0

(56) Scan parquet default.web_sales
Output [3]: [ws_item_sk#114, ws_web_site_sk#99, ws_order_number#115]
Batched: true
Location [not included in comparison]/{warehouse_dir}/web_sales]
PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_order_number), IsNotNull(ws_web_site_sk)]
ReadSchema: struct<ws_item_sk:int,ws_web_site_sk:int,ws_order_number:int>

(57) ColumnarToRow [codegen id : 16]
Input [3]: [ws_item_sk#114, ws_web_site_sk#99, ws_order_number#115]

(58) Filter [codegen id : 16]
Input [3]: [ws_item_sk#114, ws_web_site_sk#99, ws_order_number#115]
Condition : ((isnotnull(ws_item_sk#114) AND isnotnull(ws_order_number#115)) AND isnotnull(ws_web_site_sk#99))

(59) Exchange
Input [3]: [ws_item_sk#114, ws_web_site_sk#99, ws_order_number#115]
Arguments: hashpartitioning(cast(ws_item_sk#114 as bigint), cast(ws_order_number#115 as bigint), 5), true, [id=#116]

(60) Sort [codegen id : 17]
Input [3]: [ws_item_sk#114, ws_web_site_sk#99, ws_order_number#115]
Arguments: [cast(ws_item_sk#114 as bigint) ASC NULLS FIRST, cast(ws_order_number#115 as bigint) ASC NULLS FIRST], false, 0

(61) SortMergeJoin [codegen id : 18]
Left keys [2]: [wr_item_sk#109, wr_order_number#110]
Right keys [2]: [cast(ws_item_sk#114 as bigint), cast(ws_order_number#115 as bigint)]
Join condition: None

(62) Project [codegen id : 18]
Output [6]: [ws_web_site_sk#99 AS wsr_web_site_sk#117, wr_returned_date_sk#108 AS date_sk#118, 0.00 AS sales_price#119, 0.00 AS profit#120, wr_return_amt#111 AS return_amt#121, wr_net_loss#112 AS net_loss#122]
Input [8]: [wr_returned_date_sk#108, wr_item_sk#109, wr_order_number#110, wr_return_amt#111, wr_net_loss#112, ws_item_sk#114, ws_web_site_sk#99, ws_order_number#115]

(63) Union
Arguments: [wsr_web_site_sk#123, date_sk#124, sales_price#125, profit#126, return_amt#127, net_loss#128]

(64) ReusedExchange [Reuses operator id: 14]
Output [1]: [d_date_sk#27]

(65) BroadcastHashJoin [codegen id : 21]
Left keys [1]: [date_sk#124]
Right keys [1]: [cast(d_date_sk#27 as bigint)]
Join condition: None

(66) Project [codegen id : 21]
Output [5]: [wsr_web_site_sk#123, sales_price#125, profit#126, return_amt#127, net_loss#128]
Input [7]: [wsr_web_site_sk#123, date_sk#124, sales_price#125, profit#126, return_amt#127, net_loss#128, d_date_sk#27]

(67) Scan parquet default.web_site
Output [2]: [web_site_sk#129, web_site_id#130]
Batched: true
Location [not included in comparison]/{warehouse_dir}/web_site]
PushedFilters: [IsNotNull(web_site_sk)]
ReadSchema: struct<web_site_sk:int,web_site_id:string>

(68) ColumnarToRow [codegen id : 20]
Input [2]: [web_site_sk#129, web_site_id#130]

(69) Filter [codegen id : 20]
Input [2]: [web_site_sk#129, web_site_id#130]
Condition : isnotnull(web_site_sk#129)

(70) BroadcastExchange
Input [2]: [web_site_sk#129, web_site_id#130]
Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#131]

(71) BroadcastHashJoin [codegen id : 21]
Left keys [1]: [wsr_web_site_sk#123]
Right keys [1]: [web_site_sk#129]
Join condition: None

(72) Project [codegen id : 21]
Output [5]: [sales_price#125, profit#126, return_amt#127, net_loss#128, web_site_id#130]
Input [7]: [wsr_web_site_sk#123, sales_price#125, profit#126, return_amt#127, net_loss#128, web_site_sk#129, web_site_id#130]

(73) HashAggregate [codegen id : 21]
Input [5]: [sales_price#125, profit#126, return_amt#127, net_loss#128, web_site_id#130]
Keys [1]: [web_site_id#130]
Functions [4]: [partial_sum(UnscaledValue(sales_price#125)), partial_sum(UnscaledValue(return_amt#127)), partial_sum(UnscaledValue(profit#126)), partial_sum(UnscaledValue(net_loss#128))]
Aggregate Attributes [4]: [sum#132, sum#133, sum#134, sum#135]
Results [5]: [web_site_id#130, sum#136, sum#137, sum#138, sum#139]

(74) Exchange
Input [5]: [web_site_id#130, sum#136, sum#137, sum#138, sum#139]
Arguments: hashpartitioning(web_site_id#130, 5), true, [id=#140]

(75) HashAggregate [codegen id : 22]
Input [5]: [web_site_id#130, sum#136, sum#137, sum#138, sum#139]
Keys [1]: [web_site_id#130]
Functions [4]: [sum(UnscaledValue(sales_price#125)), sum(UnscaledValue(return_amt#127)), sum(UnscaledValue(profit#126)), sum(UnscaledValue(net_loss#128))]
Aggregate Attributes [4]: [sum(UnscaledValue(sales_price#125))#141, sum(UnscaledValue(return_amt#127))#142, sum(UnscaledValue(profit#126))#143, sum(UnscaledValue(net_loss#128))#144]
Results [5]: [web channel AS channel#145, concat(web_site, web_site_id#130) AS id#146, MakeDecimal(sum(UnscaledValue(sales_price#125))#141,17,2) AS sales#147, MakeDecimal(sum(UnscaledValue(return_amt#127))#142,17,2) AS returns#148, CheckOverflow((promote_precision(cast(MakeDecimal(sum(UnscaledValue(profit#126))#143,17,2) as decimal(18,2))) - promote_precision(cast(MakeDecimal(sum(UnscaledValue(net_loss#128))#144,17,2) as decimal(18,2)))), DecimalType(18,2), true) AS profit#149]

(76) Union
Arguments: [channel#150, id#151, sales#152, returns#153, profit#154]

(77) HashAggregate [codegen id : 23]
Input [5]: [channel#150, id#151, sales#152, returns#153, profit#154]
Keys [2]: [channel#150, id#151]
Functions [3]: [partial_sum(sales#152), partial_sum(returns#153), partial_sum(profit#154)]
Aggregate Attributes [6]: [sum#155, isEmpty#156, sum#157, isEmpty#158, sum#159, isEmpty#160]
Results [8]: [channel#150, id#151, sum#161, isEmpty#162, sum#163, isEmpty#164, sum#165, isEmpty#166]

(78) Exchange
Input [8]: [channel#150, id#151, sum#161, isEmpty#162, sum#163, isEmpty#164, sum#165, isEmpty#166]
Arguments: hashpartitioning(channel#150, id#151, 5), true, [id=#167]

(79) HashAggregate [codegen id : 24]
Input [8]: [channel#150, id#151, sum#161, isEmpty#162, sum#163, isEmpty#164, sum#165, isEmpty#166]
Keys [2]: [channel#150, id#151]
Functions [3]: [sum(sales#152), sum(returns#153), sum(profit#154)]
Aggregate Attributes [3]: [sum(sales#152)#168, sum(returns#153)#169, sum(profit#154)#170]
Results [5]: [channel#150, id#151, cast(sum(sales#152)#168 as decimal(37,2)) AS sales#171, cast(sum(returns#153)#169 as decimal(37,2)) AS returns#172, cast(sum(profit#154)#170 as decimal(38,2)) AS profit#173]

(80) ReusedExchange [Reuses operator id: 78]
Output [8]: [channel#174, id#175, sum#176, isEmpty#177, sum#178, isEmpty#179, sum#180, isEmpty#181]

(81) HashAggregate [codegen id : 48]
Input [8]: [channel#174, id#175, sum#176, isEmpty#177, sum#178, isEmpty#179, sum#180, isEmpty#181]
Keys [2]: [channel#174, id#175]
Functions [3]: [sum(sales#182), sum(returns#183), sum(profit#184)]
Aggregate Attributes [3]: [sum(sales#182)#185, sum(returns#183)#186, sum(profit#184)#187]
Results [4]: [channel#174, sum(sales#182)#185 AS sales#188, sum(returns#183)#186 AS returns#189, sum(profit#184)#187 AS profit#190]

(82) HashAggregate [codegen id : 48]
Input [4]: [channel#174, sales#188, returns#189, profit#190]
Keys [1]: [channel#174]
Functions [3]: [partial_sum(sales#188), partial_sum(returns#189), partial_sum(profit#190)]
Aggregate Attributes [6]: [sum#191, isEmpty#192, sum#193, isEmpty#194, sum#195, isEmpty#196]
Results [7]: [channel#174, sum#197, isEmpty#198, sum#199, isEmpty#200, sum#201, isEmpty#202]

(83) Exchange
Input [7]: [channel#174, sum#197, isEmpty#198, sum#199, isEmpty#200, sum#201, isEmpty#202]
Arguments: hashpartitioning(channel#174, 5), true, [id=#203]

(84) HashAggregate [codegen id : 49]
Input [7]: [channel#174, sum#197, isEmpty#198, sum#199, isEmpty#200, sum#201, isEmpty#202]
Keys [1]: [channel#174]
Functions [3]: [sum(sales#188), sum(returns#189), sum(profit#190)]
Aggregate Attributes [3]: [sum(sales#188)#204, sum(returns#189)#205, sum(profit#190)#206]
Results [5]: [channel#174, null AS id#207, sum(sales#188)#204 AS sum(sales)#208, sum(returns#189)#205 AS sum(returns)#209, sum(profit#190)#206 AS sum(profit)#210]

(85) Union
Arguments: [channel#211, id#212, sales#213, returns#214, profit#215]

(86) HashAggregate [codegen id : 50]
Input [5]: [channel#211, id#212, sales#213, returns#214, profit#215]
Keys [5]: [channel#211, id#212, sales#213, returns#214, profit#215]
Functions: []
Aggregate Attributes: []
Results [5]: [channel#211, id#212, sales#213, returns#214, profit#215]

(87) Exchange
Input [5]: [channel#211, id#212, sales#213, returns#214, profit#215]
Arguments: hashpartitioning(channel#211, id#212, sales#213, returns#214, profit#215, 5), true, [id=#216]

(88) HashAggregate [codegen id : 51]
Input [5]: [channel#211, id#212, sales#213, returns#214, profit#215]
Keys [5]: [channel#211, id#212, sales#213, returns#214, profit#215]
Functions: []
Aggregate Attributes: []
Results [5]: [channel#211, id#212, sales#213, returns#214, profit#215]

(89) ReusedExchange [Reuses operator id: 78]
Output [8]: [channel#217, id#218, sum#219, isEmpty#220, sum#221, isEmpty#222, sum#223, isEmpty#224]

(90) HashAggregate [codegen id : 75]
Input [8]: [channel#217, id#218, sum#219, isEmpty#220, sum#221, isEmpty#222, sum#223, isEmpty#224]
Keys [2]: [channel#217, id#218]
Functions [3]: [sum(sales#225), sum(returns#226), sum(profit#227)]
Aggregate Attributes [3]: [sum(sales#225)#228, sum(returns#226)#229, sum(profit#227)#230]
Results [3]: [sum(sales#225)#228 AS sales#188, sum(returns#226)#229 AS returns#189, sum(profit#227)#230 AS profit#190]

(91) HashAggregate [codegen id : 75]
Input [3]: [sales#188, returns#189, profit#190]
Keys: []
Functions [3]: [partial_sum(sales#188), partial_sum(returns#189), partial_sum(profit#190)]
Aggregate Attributes [6]: [sum#231, isEmpty#232, sum#233, isEmpty#234, sum#235, isEmpty#236]
Results [6]: [sum#237, isEmpty#238, sum#239, isEmpty#240, sum#241, isEmpty#242]

(92) Exchange
Input [6]: [sum#237, isEmpty#238, sum#239, isEmpty#240, sum#241, isEmpty#242]
Arguments: SinglePartition, true, [id=#243]

(93) HashAggregate [codegen id : 76]
Input [6]: [sum#237, isEmpty#238, sum#239, isEmpty#240, sum#241, isEmpty#242]
Keys: []
Functions [3]: [sum(sales#188), sum(returns#189), sum(profit#190)]
Aggregate Attributes [3]: [sum(sales#188)#244, sum(returns#189)#245, sum(profit#190)#246]
Results [5]: [null AS channel#247, null AS id#248, sum(sales#188)#244 AS sum(sales)#249, sum(returns#189)#245 AS sum(returns)#250, sum(profit#190)#246 AS sum(profit)#251]

(94) Union
Arguments: [channel#252, id#253, sales#254, returns#255, profit#256]

(95) HashAggregate [codegen id : 77]
Input [5]: [channel#252, id#253, sales#254, returns#255, profit#256]
Keys [5]: [channel#252, id#253, sales#254, returns#255, profit#256]
Functions: []
Aggregate Attributes: []
Results [5]: [channel#252, id#253, sales#254, returns#255, profit#256]

(96) Exchange
Input [5]: [channel#252, id#253, sales#254, returns#255, profit#256]
Arguments: hashpartitioning(channel#252, id#253, sales#254, returns#255, profit#256, 5), true, [id=#257]

(97) HashAggregate [codegen id : 78]
Input [5]: [channel#252, id#253, sales#254, returns#255, profit#256]
Keys [5]: [channel#252, id#253, sales#254, returns#255, profit#256]
Functions: []
Aggregate Attributes: []
Results [5]: [channel#252, id#253, sales#254, returns#255, profit#256]

(98) TakeOrderedAndProject
Input [5]: [channel#252, id#253, sales#254, returns#255, profit#256]
Arguments: 100, [channel#252 ASC NULLS FIRST, id#253 ASC NULLS FIRST], [channel#252, id#253, sales#254, returns#255, profit#256]

