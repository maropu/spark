TakeOrderedAndProject(limit=100, orderBy=[substring(w_warehouse_name, 1, 20)#0 ASC NULLS FIRST,sm_type#0 ASC NULLS FIRST,web_name#0 ASC NULLS FIRST], output=[substring(w_warehouse_name, 1, 20)#0,sm_type#0,web_name#0,30 days #0L,31 - 60 days #0L,61 - 90 days #0L,91 - 120 days #0L,>120 days #0L])
+- *HashAggregate(keys=[substring(w_warehouse_name#0, 1, 20)#0, sm_type#0, web_name#0], functions=[sum(cast(CASE WHEN ((ws_ship_date_sk#0 - ws_sold_date_sk#0) <= 30) THEN 1 ELSE 0 END as bigint)), sum(cast(CASE WHEN (((ws_ship_date_sk#0 - ws_sold_date_sk#0) > 30) && ((ws_ship_date_sk#0 - ws_sold_date_sk#0) <= 60)) THEN 1 ELSE 0 END as bigint)), sum(cast(CASE WHEN (((ws_ship_date_sk#0 - ws_sold_date_sk#0) > 60) && ((ws_ship_date_sk#0 - ws_sold_date_sk#0) <= 90)) THEN 1 ELSE 0 END as bigint)), sum(cast(CASE WHEN (((ws_ship_date_sk#0 - ws_sold_date_sk#0) > 90) && ((ws_ship_date_sk#0 - ws_sold_date_sk#0) <= 120)) THEN 1 ELSE 0 END as bigint)), sum(cast(CASE WHEN ((ws_ship_date_sk#0 - ws_sold_date_sk#0) > 120) THEN 1 ELSE 0 END as bigint))])
   +- Exchange hashpartitioning(substring(w_warehouse_name#0, 1, 20)#0, sm_type#0, web_name#0, 5)
      +- *HashAggregate(keys=[substring(w_warehouse_name#0, 1, 20) AS none#0, sm_type#0, web_name#0], functions=[partial_sum(cast(CASE WHEN ((ws_ship_date_sk#0 - ws_sold_date_sk#0) <= 30) THEN 1 ELSE 0 END as bigint)), partial_sum(cast(CASE WHEN (((ws_ship_date_sk#0 - ws_sold_date_sk#0) > 30) && ((ws_ship_date_sk#0 - ws_sold_date_sk#0) <= 60)) THEN 1 ELSE 0 END as bigint)), partial_sum(cast(CASE WHEN (((ws_ship_date_sk#0 - ws_sold_date_sk#0) > 60) && ((ws_ship_date_sk#0 - ws_sold_date_sk#0) <= 90)) THEN 1 ELSE 0 END as bigint)), partial_sum(cast(CASE WHEN (((ws_ship_date_sk#0 - ws_sold_date_sk#0) > 90) && ((ws_ship_date_sk#0 - ws_sold_date_sk#0) <= 120)) THEN 1 ELSE 0 END as bigint)), partial_sum(cast(CASE WHEN ((ws_ship_date_sk#0 - ws_sold_date_sk#0) > 120) THEN 1 ELSE 0 END as bigint))])
         +- *Project [sm_type#0, ws_sold_date_sk#0, web_name#0, ws_ship_date_sk#0, w_warehouse_name#0]
            +- *BroadcastHashJoin [ws_ship_date_sk#0], [d_date_sk#0], Inner, BuildRight
               :- *Project [sm_type#0, ws_sold_date_sk#0, web_name#0, ws_ship_date_sk#0, w_warehouse_name#0]
               :  +- *BroadcastHashJoin [ws_web_site_sk#0], [web_site_sk#0], Inner, BuildRight
               :     :- *Project [sm_type#0, ws_sold_date_sk#0, ws_ship_date_sk#0, w_warehouse_name#0, ws_web_site_sk#0]
               :     :  +- *BroadcastHashJoin [ws_ship_mode_sk#0], [sm_ship_mode_sk#0], Inner, BuildRight
               :     :     :- *Project [ws_sold_date_sk#0, ws_ship_date_sk#0, ws_ship_mode_sk#0, w_warehouse_name#0, ws_web_site_sk#0]
               :     :     :  +- *BroadcastHashJoin [ws_warehouse_sk#0], [w_warehouse_sk#0], Inner, BuildRight
               :     :     :     :- *Project [ws_warehouse_sk#0, ws_sold_date_sk#0, ws_ship_date_sk#0, ws_ship_mode_sk#0, ws_web_site_sk#0]
               :     :     :     :  +- *Filter (((isnotnull(ws_warehouse_sk#0) && isnotnull(ws_web_site_sk#0)) && isnotnull(ws_ship_mode_sk#0)) && isnotnull(ws_ship_date_sk#0))
               :     :     :     :     +- *FileScan parquet default.web_sales[ws_sold_date_sk#0,ws_ship_date_sk#0,ws_web_site_sk#0,ws_ship_mode_sk#0,ws_warehouse_sk#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,ws_warehous...
               :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
               :     :     :        +- *Project [w_warehouse_sk#0, w_warehouse_name#0]
               :     :     :           +- *Filter isnotnull(w_warehouse_sk#0)
               :     :     :              +- *FileScan parquet default.warehouse[w_warehouse_sk#0,w_warehouse_name#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,w_warehouse_name:string>
               :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
               :     :        +- *Project [sm_type#0, sm_ship_mode_sk#0]
               :     :           +- *Filter isnotnull(sm_ship_mode_sk#0)
               :     :              +- *FileScan parquet default.ship_mode[sm_ship_mode_sk#0,sm_type#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,sm_type:string>
               :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
               :        +- *Project [web_site_sk#0, web_name#0]
               :           +- *Filter isnotnull(web_site_sk#0)
               :              +- *FileScan parquet default.web_site[web_site_sk#0,web_name#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,web_name:string>
               +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                  +- *Project [d_date_sk#0]
                     +- *Filter (((isnotnull(d_date_sk#0) && (1211 >= d_month_seq#0)) && isnotnull(d_month_seq#0)) && (1200 <= d_month_seq#0))
                        +- *FileScan parquet default.date_dim[d_date_sk#0,d_month_seq#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,d_month_seq:int>
