TakeOrderedAndProject(limit=100, orderBy=[ca_zip#0 ASC NULLS FIRST], output=[ca_zip#0,sum(cs_sales_price)#0])
+- *HashAggregate(keys=[ca_zip#0], functions=[sum(UnscaledValue(cs_sales_price#0))])
   +- Exchange hashpartitioning(ca_zip#0, 5)
      +- *HashAggregate(keys=[ca_zip#0], functions=[partial_sum(UnscaledValue(cs_sales_price#0))])
         +- *Project [cs_sales_price#0, ca_zip#0]
            +- *BroadcastHashJoin [cs_sold_date_sk#0], [d_date_sk#0], Inner, BuildRight
               :- *Project [cs_sales_price#0, cs_sold_date_sk#0, ca_zip#0]
               :  +- *BroadcastHashJoin [c_current_addr_sk#0], [ca_address_sk#0], Inner, BuildRight, ((substring(ca_zip#0, 1, 5) IN (85669,86197,88274,83405,86475,85392,85460,80348,81792) || ca_state#0 IN (CA,WA,GA)) || (cs_sales_price#0 > 500.00))
               :     :- *Project [c_current_addr_sk#0, cs_sales_price#0, cs_sold_date_sk#0]
               :     :  +- *BroadcastHashJoin [cs_bill_customer_sk#0], [c_customer_sk#0], Inner, BuildRight
               :     :     :- *Project [cs_sales_price#0, cs_bill_customer_sk#0, cs_sold_date_sk#0]
               :     :     :  +- *Filter (isnotnull(cs_sold_date_sk#0) && isnotnull(cs_bill_customer_sk#0))
               :     :     :     +- *FileScan parquet default.catalog_sales[cs_sold_date_sk#0,cs_bill_customer_sk#0,cs_sales_price#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,2)>
               :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
               :     :        +- *Project [c_current_addr_sk#0, c_customer_sk#0]
               :     :           +- *Filter (isnotnull(c_current_addr_sk#0) && isnotnull(c_customer_sk#0))
               :     :              +- *FileScan parquet default.customer[c_customer_sk#0,c_current_addr_sk#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,c_current_addr_sk:int>
               :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
               :        +- *Project [ca_address_sk#0, ca_zip#0, ca_state#0]
               :           +- *Filter isnotnull(ca_address_sk#0)
               :              +- *FileScan parquet default.customer_address[ca_address_sk#0,ca_state#0,ca_zip#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,ca_zip:string>
               +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                  +- *Project [d_date_sk#0]
                     +- *Filter ((((isnotnull(d_date_sk#0) && (2 = d_qoy#0)) && (2001 = d_year#0)) && isnotnull(d_year#0)) && isnotnull(d_qoy#0))
                        +- *FileScan parquet default.date_dim[d_date_sk#0,d_year#0,d_qoy#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,d_qoy:int>
