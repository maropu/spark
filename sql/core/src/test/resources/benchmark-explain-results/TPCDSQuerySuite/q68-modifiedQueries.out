TakeOrderedAndProject(limit=100, orderBy=[c_last_name#0 ASC NULLS FIRST,ss_ticket_number#0 ASC NULLS FIRST], output=[c_last_name#0,c_first_name#0,ca_city#0,bought_city#0,ss_ticket_number#0,extended_price#0,extended_tax#0,list_price#0])
+- *Project [c_last_name#0, extended_price#0, ss_ticket_number#0, list_price#0, ca_city#0, extended_tax#0, bought_city#0, c_first_name#0]
   +- *BroadcastHashJoin [c_current_addr_sk#0], [ca_address_sk#0], Inner, BuildRight, NOT (ca_city#0 = bought_city#0)
      :- *Project [c_current_addr_sk#0, extended_tax#0, bought_city#0, c_first_name#0, c_last_name#0, extended_price#0, list_price#0, ss_ticket_number#0]
      :  +- *BroadcastHashJoin [ss_customer_sk#0], [c_customer_sk#0], Inner, BuildRight
      :     :- *HashAggregate(keys=[ss_ticket_number#0, ss_customer_sk#0, ss_addr_sk#0, ca_city#0], functions=[sum(UnscaledValue(ss_ext_sales_price#0)), sum(UnscaledValue(ss_ext_list_price#0)), sum(UnscaledValue(ss_ext_tax#0))])
      :     :  +- Exchange hashpartitioning(ss_ticket_number#0, ss_customer_sk#0, ss_addr_sk#0, ca_city#0, 5)
      :     :     +- *HashAggregate(keys=[ss_ticket_number#0, ss_customer_sk#0, ss_addr_sk#0, ca_city#0], functions=[partial_sum(UnscaledValue(ss_ext_sales_price#0)), partial_sum(UnscaledValue(ss_ext_list_price#0)), partial_sum(UnscaledValue(ss_ext_tax#0))])
      :     :        +- *Project [ca_city#0, ss_ext_list_price#0, ss_ticket_number#0, ss_customer_sk#0, ss_addr_sk#0, ss_ext_sales_price#0, ss_ext_tax#0]
      :     :           +- *BroadcastHashJoin [ss_addr_sk#0], [ca_address_sk#0], Inner, BuildRight
      :     :              :- *Project [ss_ext_list_price#0, ss_ticket_number#0, ss_customer_sk#0, ss_addr_sk#0, ss_ext_sales_price#0, ss_ext_tax#0]
      :     :              :  +- *BroadcastHashJoin [ss_hdemo_sk#0], [hd_demo_sk#0], Inner, BuildRight
      :     :              :     :- *Project [ss_hdemo_sk#0, ss_ext_list_price#0, ss_ticket_number#0, ss_customer_sk#0, ss_addr_sk#0, ss_ext_sales_price#0, ss_ext_tax#0]
      :     :              :     :  +- *BroadcastHashJoin [ss_store_sk#0], [s_store_sk#0], Inner, BuildRight
      :     :              :     :     :- *Project [ss_hdemo_sk#0, ss_ext_list_price#0, ss_ticket_number#0, ss_store_sk#0, ss_customer_sk#0, ss_addr_sk#0, ss_ext_sales_price#0, ss_ext_tax#0]
      :     :              :     :     :  +- *BroadcastHashJoin [ss_sold_date_sk#0], [d_date_sk#0], Inner, BuildRight
      :     :              :     :     :     :- *Project [ss_hdemo_sk#0, ss_ext_list_price#0, ss_ticket_number#0, ss_store_sk#0, ss_sold_date_sk#0, ss_customer_sk#0, ss_addr_sk#0, ss_ext_sales_price#0, ss_ext_tax#0]
      :     :              :     :     :     :  +- *Filter (((((isnotnull(ss_hdemo_sk#0) && isnotnull(ss_customer_sk#0)) && ss_sold_date_sk#0 INSET (2451790,2451180,2452216,2451454,2452184,2451485,2451850,2451514,2452062,2451270,2452123,2451758,2451971,2451546,2451942,2451393,2451667,2451453,2452215,2451819,2451331,2451577,2451911,2452245,2451301,2451545,2451605,2451943,2451851,2451181,2452154,2451820,2452001,2451362,2451392,2451240,2452032,2451637,2451484,2452124,2451300,2451727,2452093,2451759,2451698,2451332,2451606,2451666,2451912,2452185,2451211,2451361,2452031,2451212,2451880,2451789,2451423,2451576,2451728,2452246,2452155,2452092,2451881,2451970,2451697,2452063,2451271,2451636,2451515,2451424,2451239,2452002)) && isnotnull(ss_store_sk#0)) && isnotnull(ss_sold_date_sk#0)) && isnotnull(ss_addr_sk#0))
      :     :              :     :     :     :     +- *FileScan parquet default.store_sales[ss_sold_date_sk#0,ss_customer_sk#0,ss_hdemo_sk#0,ss_addr_sk#0,ss_store_sk#0,ss_ticket_number#0,ss_ext_sales_price#0,ss_ext_list_price#0,ss_ext_tax#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,ss_t...
      :     :              :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
      :     :              :     :     :        +- *Project [d_date_sk#0]
      :     :              :     :     :           +- *Filter (((((isnotnull(d_date_sk#0) && isnotnull(d_dom#0)) && (2 >= d_dom#0)) && (1 <= d_dom#0)) && d_date_sk#0 INSET (2451790,2451180,2452216,2451454,2452184,2451485,2451850,2451514,2452062,2451270,2452123,2451758,2451971,2451546,2451942,2451393,2451667,2451453,2452215,2451819,2451331,2451577,2451911,2452245,2451301,2451545,2451605,2451943,2451851,2451181,2452154,2451820,2452001,2451362,2451392,2451240,2452032,2451637,2451484,2452124,2451300,2451727,2452093,2451759,2451698,2451332,2451606,2451666,2451912,2452185,2451211,2451361,2452031,2451212,2451880,2451789,2451423,2451576,2451728,2452246,2452155,2452092,2451881,2451970,2451697,2452063,2451271,2451636,2451515,2451424,2451239,2452002)) && d_year#0 IN (1999,2000,2001))
      :     :              :     :     :              +- *FileScan parquet default.date_dim[d_date_sk#0,d_year#0,d_dom#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,d_dom:int>
      :     :              :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
      :     :              :     :        +- *Project [s_store_sk#0]
      :     :              :     :           +- *Filter (isnotnull(s_store_sk#0) && s_city#0 IN (Midway,Fairview))
      :     :              :     :              +- *FileScan parquet default.store[s_store_sk#0,s_city#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,s_city:string>
      :     :              :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
      :     :              :        +- *Project [hd_demo_sk#0]
      :     :              :           +- *Filter (((3 = hd_vehicle_count#0) || (hd_dep_count#0 = 5)) && isnotnull(hd_demo_sk#0))
      :     :              :              +- *FileScan parquet default.household_demographics[hd_demo_sk#0,hd_dep_count#0,hd_vehicle_count#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,hd_vehicle_count:int>
      :     :              +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
      :     :                 +- *Project [ca_city#0, ca_address_sk#0]
      :     :                    +- *Filter (isnotnull(ca_city#0) && isnotnull(ca_address_sk#0))
      :     :                       +- *FileScan parquet default.customer_address[ca_address_sk#0,ca_city#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,ca_city:string>
      :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
      :        +- *Project [c_current_addr_sk#0, c_first_name#0, c_last_name#0, c_customer_sk#0]
      :           +- *Filter (isnotnull(c_current_addr_sk#0) && isnotnull(c_customer_sk#0))
      :              +- *FileScan parquet default.customer[c_customer_sk#0,c_current_addr_sk#0,c_first_name#0,c_last_name#0] Batched: true, Format: Parquet, Location: InMemoryFileIndex[<PATH>,c_last_name:string>
      +- ReusedExchange [ca_address_sk#0, ca_city#0], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
